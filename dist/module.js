import t from"assert";import e from"util";import"@foo-dog/utils";import r from"lodash";import s from"debug";import{AttrResolver as i}from"@foo-dog/attrs";function n(t,e){var r;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonParserError"}),null==t&&(t="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:t}),this.hash=e,e&&e.exception instanceof Error){var s=e.exception;this.message=s.message||t,r=s.stack}r||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):r=new Error(t).stack),r&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:r})}function a(t,e,r){r=r||0;for(var s=0;s<e;s++)this.push(t),t+=r}function o(t,e){for(e+=t=this.length-t;t<e;t++)this.push(this[t])}function l(t){for(var e=[],r=0,s=t.length;r<s;r++){var i=t[r];"function"==typeof i?(r++,i.apply(e,t[r])):e.push(i)}return e}"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(n.prototype,Error.prototype):n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n.prototype.name="JisonParserError";var h={trace:function(){},JisonParserError:n,yy:{},options:{type:"lalr",hasPartialLrUpgradeOnConflict:!0,errorRecoveryTokenDiscardCount:3,tokenStack:!0,ebnf:!0},symbols_:{$accept:0,$end:1,ASSIGN_PART:13,ATTR:12,BODY:11,CLASSNAME:14,DOT:10,EOF:1,EQ:7,FILTER_START:6,INTERPOLATION:9,TAG:3,TAG_END:5,TAG_START:4,TEXT:8,error:2,line:16,line_part:17,line_part_repetition:41,line_part_repetition2:42,line_part_repetition3:43,line_part_repetition4:44,line_part_repetition5:45,line_part_repetition_plus:18,line_part_repetition_plus10:27,line_part_repetition_plus11:28,line_part_repetition_plus12:29,line_part_repetition_plus13:30,line_part_repetition_plus14:31,line_part_repetition_plus15:32,line_part_repetition_plus16:33,line_part_repetition_plus17:34,line_part_repetition_plus18:35,line_part_repetition_plus19:36,line_part_repetition_plus2:19,line_part_repetition_plus20:37,line_part_repetition_plus21:38,line_part_repetition_plus22:39,line_part_repetition_plus23:40,line_part_repetition_plus3:20,line_part_repetition_plus4:21,line_part_repetition_plus5:22,line_part_repetition_plus6:23,line_part_repetition_plus7:24,line_part_repetition_plus8:25,line_part_repetition_plus9:26,start:15},terminals_:{1:"EOF",2:"error",3:"TAG",4:"TAG_START",5:"TAG_END",6:"FILTER_START",7:"EQ",8:"TEXT",9:"INTERPOLATION",10:"DOT",11:"BODY",12:"ATTR",13:"ASSIGN_PART",14:"CLASSNAME"},TERROR:2,EOF:1,originalQuoteName:null,originalParseError:null,cleanupAfterParse:null,constructParseErrorInfo:null,yyMergeLocationInfo:null,__reentrant_call_depth:0,__error_infos:[],__error_recovery_infos:[],quoteName:function(t){return'"'+t+'"'},getSymbolName:function(t){if(this.terminals_[t])return this.terminals_[t];var e=this.symbols_;for(var r in e)if(e[r]===t)return r;return null},describeSymbol:function(t){if(t!==this.EOF&&this.terminal_descriptions_&&this.terminal_descriptions_[t])return this.terminal_descriptions_[t];if(t===this.EOF)return"end of input";var e=this.getSymbolName(t);return e?this.quoteName(e):null},collect_expected_token_set:function(t,e){var r=this.TERROR,s=[],i={};if(!e&&this.state_descriptions_&&this.state_descriptions_[t])return[this.state_descriptions_[t]];for(var n in this.table[t])if((n=+n)!==r){var a=e?n:this.describeSymbol(n);a&&!i[a]&&(s.push(a),i[a]=!0)}return s},productions_:function(t){for(var e=[],r=t.pop,s=t.rule,i=0,n=r.length;i<n;i++)e.push([r[i],s[i]]);return e}({pop:l([15,16,16,a,[17,22],18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39,40,40,41,41,42,42,43,43,44,44,45,45]),rule:l([2,2,1,0,1,1,2,a,[3,3],4,4,o,[6,6],4,5,5,6,2,6,4,1,2,1,2,o,[4,42],0,2,0,o,[4,7]])}),performAction:function(t,e,r){var s=this.yy;s.parser,s.lexer;switch(t){case 0:case 1:
/*! Production::    start : line EOF */
this.$=r[e-1];break;case 2:
/*! Production::    line : line line_part */u("line: line line_part: $line=",r[e-1],", $line_part=",r[e]),Array.isArray(r[e-1])?this.$=r[e-1]:this.$=[r[e-1]],this.$.push(r[e]);break;case 3:
/*! Production::    line : line_part */u("line: line_part: $line_part=",r[e]),Array.isArray(r[e])?this.$=r[e]:this.$=[r[e]];break;case 4:
/*! Production::    line_part : %epsilon */
this.$=void 0;break;case 5:
/*! Production::    line_part : TAG */let[t,i,n]=r[e];u("$TAG=",r[e]),u("tag_name=",t),u("attrs=",i),u("body=",n);const a={type:"tag",name:t,attrs:i};if(null==i&&delete a.attrs,""==n)delete a.val;else if(n.includes("<")&&n.includes(">")){u("parsing ",n);let t=s.parser.parse(n);u("parsedBody=",t),1!=t.length||"text"!=t[0].type||t[0].hasOwnProperty("children")?a.children=a.hasOwnProperty("children")?a.children.push(...t):t:a.val=t[0].val}else a.val=n;this.$=a;break;case 6:
/*! Production::    line_part : line_part_repetition_plus */this.$={type:"text",val:r[e].join("")};break;case 7:
/*! Production::    line_part : TAG_START TAG_END */this.$={type:"tag",name:r[e-1]};break;case 8:
/*! Production::    line_part : TAG_START line_part_repetition_plus2 TAG_END */case 9:
/*! Production::    line_part : TAG_START line_part_repetition_plus3 TAG_END */this.$={type:"tag",name:r[e-2],val:r[e-1].join("")};break;case 10:
/*! Production::    line_part : TAG_START line_part_repetition_plus4 TAG_END */this.$={type:"tag",name:r[e-2],attrs:S.parse(r[e-1].join(""))};break;case 11:
/*! Production::    line_part : TAG_START line_part_repetition_plus5 line_part_repetition_plus6 TAG_END */case 12:
/*! Production::    line_part : TAG_START line_part_repetition_plus7 line_part_repetition_plus8 TAG_END */this.$={type:"tag",name:r[e-3],val:r[e-1].join(""),attrs:S.parse(r[e-2].join(""))};break;case 13:
/*! Production::    line_part : FILTER_START TAG_END */this.$={type:"filter",name:r[e-1]};break;case 14:
/*! Production::    line_part : FILTER_START line_part_repetition_plus9 TAG_END */case 15:
/*! Production::    line_part : FILTER_START line_part_repetition_plus10 TAG_END */this.$={type:"filter",name:r[e-2],val:r[e-1].join("")};break;case 16:
/*! Production::    line_part : FILTER_START line_part_repetition_plus11 TAG_END */this.$={type:"filter",name:r[e-2],attrs:S.parse(r[e-1].join(""))};break;case 17:
/*! Production::    line_part : FILTER_START line_part_repetition_plus12 line_part_repetition_plus13 TAG_END */case 18:
/*! Production::    line_part : FILTER_START line_part_repetition_plus14 line_part_repetition_plus15 TAG_END */this.$={type:"filter",name:r[e-3],val:r[e-1].join(""),attrs:S.parse(r[e-2].join(""))};break;case 19:
/*! Production::    line_part : TAG_START EQ line_part_repetition_plus16 TAG_END */this.$={type:"tag",name:r[e-3],assignment:r[e-1].join("")};break;case 20:
/*! Production::    line_part : TAG_START EQ line_part_repetition_plus17 line_part_repetition_plus18 TAG_END */this.$={type:"tag",name:r[e-4],assignment:r[e-2].join(""),attrs:S.parse(r[e].join(""))};break;case 21:
/*! Production::    line_part : TAG_START EQ line_part_repetition_plus19 line_part_repetition_plus20 TAG_END */this.$={type:"tag",name:r[e-4],assignment:r[e-2].join(""),val:r[e].join("")};break;case 22:
/*! Production::    line_part : TAG_START EQ line_part_repetition_plus21 line_part_repetition_plus22 line_part_repetition_plus23 TAG_END */this.$={type:"tag",name:r[e-5],assignment:r[e-3].join(""),val:r[e].join(""),attrs:S.parse(r[e-1].join(""))};break;case 23:
/*! Production::    line_part : TEXT INTERPOLATION */this.$=[{type:"text",val:r[e-1]},{type:"interp",val:r[e]}];break;case 24:
/*! Production::    line_part : TAG_START DOT line_part_repetition line_part_repetition2 line_part_repetition3 TAG_END */this.$={type:"tag",name:r[e-5]},r[e-3]&&(this.$.classes=r[e-3]),r[e-2]&&(this.$.attrs=S.parse(r[e-2].join(""))),r[e-1]&&(this.$.val=r[e-1].join(""));break;case 25:
/*! Production::    line_part : TAG_START line_part_repetition4 line_part_repetition5 TAG_END */u("TAG_START ATTR* BODY* TAG_END"),this.$={type:"tag",name:r[e-3]},r[e-2]&&(this.$.attrs=S.parse(r[e-2].join(""))),r[e-1]&&(this.$.val=r[e-1].join(""));break;case 26:
/*! Production::    line_part_repetition_plus : TEXT */case 28:
/*! Production::    line_part_repetition_plus2 : BODY */case 30:
/*! Production::    line_part_repetition_plus3 : BODY */case 32:
/*! Production::    line_part_repetition_plus4 : ATTR */case 34:
/*! Production::    line_part_repetition_plus5 : ATTR */case 36:
/*! Production::    line_part_repetition_plus6 : BODY */case 38:
/*! Production::    line_part_repetition_plus7 : ATTR */case 40:
/*! Production::    line_part_repetition_plus8 : BODY */case 42:
/*! Production::    line_part_repetition_plus9 : BODY */case 44:
/*! Production::    line_part_repetition_plus10 : BODY */case 46:
/*! Production::    line_part_repetition_plus11 : ATTR */case 48:
/*! Production::    line_part_repetition_plus12 : ATTR */case 50:
/*! Production::    line_part_repetition_plus13 : BODY */case 52:
/*! Production::    line_part_repetition_plus14 : ATTR */case 54:
/*! Production::    line_part_repetition_plus15 : BODY */case 56:
/*! Production::    line_part_repetition_plus16 : ASSIGN_PART */case 58:
/*! Production::    line_part_repetition_plus17 : ASSIGN_PART */case 60:
/*! Production::    line_part_repetition_plus18 : ATTR */case 62:
/*! Production::    line_part_repetition_plus19 : ASSIGN_PART */case 64:
/*! Production::    line_part_repetition_plus20 : BODY */case 66:
/*! Production::    line_part_repetition_plus21 : ASSIGN_PART */case 68:
/*! Production::    line_part_repetition_plus22 : ATTR */case 70:
/*! Production::    line_part_repetition_plus23 : BODY */this.$=[r[e]];break;case 27:
/*! Production::    line_part_repetition_plus : line_part_repetition_plus TEXT */case 29:
/*! Production::    line_part_repetition_plus2 : line_part_repetition_plus2 BODY */case 31:
/*! Production::    line_part_repetition_plus3 : line_part_repetition_plus3 BODY */case 33:
/*! Production::    line_part_repetition_plus4 : line_part_repetition_plus4 ATTR */case 35:
/*! Production::    line_part_repetition_plus5 : line_part_repetition_plus5 ATTR */case 37:
/*! Production::    line_part_repetition_plus6 : line_part_repetition_plus6 BODY */case 39:
/*! Production::    line_part_repetition_plus7 : line_part_repetition_plus7 ATTR */case 41:
/*! Production::    line_part_repetition_plus8 : line_part_repetition_plus8 BODY */case 43:
/*! Production::    line_part_repetition_plus9 : line_part_repetition_plus9 BODY */case 45:
/*! Production::    line_part_repetition_plus10 : line_part_repetition_plus10 BODY */case 47:
/*! Production::    line_part_repetition_plus11 : line_part_repetition_plus11 ATTR */case 49:
/*! Production::    line_part_repetition_plus12 : line_part_repetition_plus12 ATTR */case 51:
/*! Production::    line_part_repetition_plus13 : line_part_repetition_plus13 BODY */case 53:
/*! Production::    line_part_repetition_plus14 : line_part_repetition_plus14 ATTR */case 55:
/*! Production::    line_part_repetition_plus15 : line_part_repetition_plus15 BODY */case 57:
/*! Production::    line_part_repetition_plus16 : line_part_repetition_plus16 ASSIGN_PART */case 59:
/*! Production::    line_part_repetition_plus17 : line_part_repetition_plus17 ASSIGN_PART */case 61:
/*! Production::    line_part_repetition_plus18 : line_part_repetition_plus18 ATTR */case 63:
/*! Production::    line_part_repetition_plus19 : line_part_repetition_plus19 ASSIGN_PART */case 65:
/*! Production::    line_part_repetition_plus20 : line_part_repetition_plus20 BODY */case 67:
/*! Production::    line_part_repetition_plus21 : line_part_repetition_plus21 ASSIGN_PART */case 69:
/*! Production::    line_part_repetition_plus22 : line_part_repetition_plus22 ATTR */case 71:
/*! Production::    line_part_repetition_plus23 : line_part_repetition_plus23 BODY */case 73:
/*! Production::    line_part_repetition : line_part_repetition CLASSNAME */case 75:
/*! Production::    line_part_repetition2 : line_part_repetition2 ATTR */case 77:
/*! Production::    line_part_repetition3 : line_part_repetition3 BODY */case 79:
/*! Production::    line_part_repetition4 : line_part_repetition4 ATTR */case 81:
/*! Production::    line_part_repetition5 : line_part_repetition5 BODY */r[e-1].push(r[e]),this.$=r[e-1];break;case 72:
/*! Production::    line_part_repetition : %epsilon */case 74:
/*! Production::    line_part_repetition2 : %epsilon */case 76:
/*! Production::    line_part_repetition3 : %epsilon */case 78:
/*! Production::    line_part_repetition4 : %epsilon */case 80:
/*! Production::    line_part_repetition5 : %epsilon */this.$=[]}},table:function(t){for(var e=[],r=t.len,s=t.symbol,i=t.type,n=t.state,a=t.mode,o=t.goto,l=0,h=r.length;l<h;l++){for(var c=r[l],u={},p=0;p<c;p++){var y=s.shift();switch(i.shift()){case 2:u[y]=[a.shift(),o.shift()];break;case 0:u[y]=n.shift();break;default:u[y]=[3]}}e.push(u)}return e}({len:l([9,1,7,0,0,5,11,8,6,a,[0,4],a,[2,3],3,3,5,1,4,0,3,o,[11,6],o,[8,3],a,[0,6],2,o,[3,6],a,[3,3],4,5,o,[9,3],o,[20,11],o,[12,12],o,[46,3],4,a,[0,11],o,[33,9]]),symbol:l([1,3,4,6,8,a,[15,4,1],1,o,[10,5],o,[8,3],o,[7,4],5,7,10,11,12,a,[19,4,1],24,44,5,11,12,a,[26,4,1],31,o,[24,5],9,5,11,5,11,5,12,11,12,23,11,12,25,13,33,34,36,38,41,o,[32,3],45,o,[4,3],o,[25,8],30,11,12,32,o,[15,8],13,12,13,35,11,13,37,12,13,39,o,[18,3],13,o,[4,3],14,42,o,[24,5],o,[41,3],5,11,11,12,40,o,[18,3],43,o,[15,4]]),type:l([a,[2,5],a,[0,4],1,o,[10,7],a,[2,10],a,[0,6],o,[9,8],a,[2,14],o,[15,3],0,o,[24,9],o,[28,12],o,[25,5],o,[15,16],o,[18,9],o,[70,13],o,[59,9]]),state:l([1,2,3,5,10,5,a,[13,5,1],20,a,[24,5,1],38,41,a,[44,4,1],49,50,58,61,a,[70,4,3],91,94]),mode:l([2,a,[1,9],a,[2,4],o,[13,13],o,[14,10],o,[17,5],o,[20,4],o,[16,12],o,[31,15],o,[50,17],o,[51,4],a,[1,4]]),goto:l([4,4,a,[6,4,1],o,[5,4],a,[6,4],11,12,18,19,21,22,23,29,30,a,[26,5],a,[31,7,1],40,39,43,42,48,80,80,51,32,34,32,a,[52,6,1],60,59,63,62,46,48,46,a,[64,6,1],72,71,75,74,78,77,56,62,58,56,a,[74,3],a,[80,11,1],93,92,76,76,a,[95,5,1]])}),defaultActions:function(t){for(var e={},r=t.idx,s=t.goto,i=0,n=r.length;i<n;i++){e[r[i]]=s[i]}return e}({idx:l([3,4,a,[9,4,1],19,21,23,29,a,[31,7,1],39,40,42,43,a,[51,7,1],59,60,a,[62,8,1],71,72,74,75,77,78,a,[80,11,1],92,93,a,[95,5,1]]),goto:l([3,5,1,2,27,7,72,28,13,42,23,8,29,9,31,10,33,35,36,39,40,79,14,43,15,45,16,47,49,50,53,54,11,37,12,41,19,57,59,60,63,64,67,68,73,25,81,17,51,18,55,20,61,21,65,69,70,75,22,71,24,77])}),parseError:function(t,e,r){if(!e.recoverable)throw"function"==typeof this.trace&&this.trace(t),r||(r=this.JisonParserError),new r(t,e);"function"==typeof this.trace&&this.trace(t),e.destroy()},parse:function(t){var e,r=this,s=new Array(128),i=new Array(128),n=[],a=new Array(128),o=this.table,l=0,h=0,c=(this.TERROR,this.EOF),u=(this.options.errorRecoveryTokenDiscardCount,[0,100]);e=this.__lexer__?this.__lexer__:this.__lexer__=Object.create(this.lexer);var p,y,_,f,m={parseError:void 0,quoteName:void 0,lexer:void 0,parser:void 0,pre_parse:void 0,post_parse:void 0,pre_lex:void 0,post_lex:void 0};function g(){var t;return"number"!=typeof(t=n.pop()||e.lex()||c)&&(t instanceof Array&&(t=(n=t).pop()),"number"!=typeof t&&(t=r.symbols_[t]||t)),t||c}this.yyGetSharedState=function(){return m},function(t,e){for(var r in e)void 0===t[r]&&Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}(m,this.yy),m.lexer=e,m.parser=this,"function"==typeof m.parseError?this.parseError=function(t,e,r){return r||(r=this.JisonParserError),m.parseError.call(this,t,e,r)}:this.parseError=this.originalParseError,"function"==typeof m.quoteName?this.quoteName=function(t){return m.quoteName.call(this,t)}:this.quoteName=this.originalQuoteName,this.cleanupAfterParse=function(t,r,n){var o,h;r&&((m.post_parse||this.post_parse)&&(h=this.constructParseErrorInfo(null,null,null,!1)),m.post_parse&&void 0!==(o=m.post_parse.call(this,m,t,h))&&(t=o),this.post_parse&&void 0!==(o=this.post_parse.call(this,m,t,h))&&(t=o),h&&h.destroy&&h.destroy());if(this.__reentrant_call_depth>1)return t;if(e.cleanupAfterLex&&e.cleanupAfterLex(n),m&&(m.lexer=void 0,m.parser=void 0,e.yy===m&&(e.yy=void 0)),m=void 0,this.parseError=this.originalParseError,this.quoteName=this.originalQuoteName,s.length=0,i.length=0,a.length=0,l=0,!n){for(var c=this.__error_infos.length-1;c>=0;c--){var u=this.__error_infos[c];u&&"function"==typeof u.destroy&&u.destroy()}this.__error_infos.length=0}return t},this.constructParseErrorInfo=function(t,r,n,o){var c={errStr:t,exception:r,text:e.match,value:e.yytext,token:this.describeSymbol(h)||h,token_id:h,line:e.yylineno,expected:n,recoverable:o,state:p,action:y,new_state:E,symbol_stack:s,state_stack:i,value_stack:a,stack_pointer:l,yy:m,lexer:e,parser:this,destroy:function(){var t=!!this.recoverable;for(var e in this)this.hasOwnProperty(e)&&"object"==typeof e&&(this[e]=void 0);this.recoverable=t}};return this.__error_infos.push(c),c};var d,v,b,E,x={$:!0,_$:void 0,yy:m},T=!1;try{if(this.__reentrant_call_depth++,e.setInput(t,m),"function"==typeof e.canIUse)e.canIUse().fastLex&&"function"==typeof fastLex&&(g=fastLex);for(a[l]=null,i[l]=0,s[l]=0,++l,this.pre_parse&&this.pre_parse.call(this,m),m.pre_parse&&m.pre_parse.call(this,m),E=i[l-1];;){if(p=E,this.defaultActions[p])y=2,E=this.defaultActions[p];else if(h||(h=g()),f=o[p]&&o[p][h]||u,E=f[1],!(y=f[0])){var A,S=this.describeSymbol(h)||h,k=this.collect_expected_token_set(p);A="number"==typeof e.yylineno?"Parse error on line "+(e.yylineno+1)+": ":"Parse error: ","function"==typeof e.showPosition&&(A+="\n"+e.showPosition(69,10)+"\n"),k.length?A+="Expecting "+k.join(", ")+", got unexpected "+S:A+="Unexpected "+S,d=this.constructParseErrorInfo(A,null,k,!1),void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_);break}switch(y){default:if(y instanceof Array){d=this.constructParseErrorInfo("Parse Error: multiple actions possible at state: "+p+", token: "+h,null,null,!1),void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_);break}d=this.constructParseErrorInfo("Parsing halted. No viable error recovery approach available due to internal system failure.",null,null,!1),void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_);break;case 1:s[l]=h,a[l]=e.yytext,i[l]=E,++l,h=0;continue;case 2:if(v=(b=this.productions_[E-1])[1],void 0!==(_=this.performAction.call(x,E,l-1,a))){T=_;break}l-=v;var R=b[0];s[l]=R,a[l]=x.$,E=o[i[l-1]][R],i[l]=E,++l;continue;case 3:-2!==l&&(T=!0,l--,void 0!==a[l]&&(T=a[l]))}break}}catch(t){if(t instanceof this.JisonParserError)throw t;if(e&&"function"==typeof e.JisonLexerError&&t instanceof e.JisonLexerError)throw t;d=this.constructParseErrorInfo("Parsing aborted due to exception.",t,null,!1),T=!1,void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_)}finally{T=this.cleanupAfterParse(T,!0,!0),this.__reentrant_call_depth--}return T}};h.originalParseError=h.parseError,h.originalQuoteName=h.quoteName;var c=function(){function t(t,e){var r;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonLexerError"}),null==t&&(t="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:t}),this.hash=e,e&&e.exception instanceof Error){var s=e.exception;this.message=s.message||t,r=s.stack}r||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):r=new Error(t).stack),r&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:r})}"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(t.prototype,Error.prototype):t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t.prototype.name="JisonLexerError";var e={EOF:1,ERROR:2,__currentRuleSet__:null,__error_infos:[],__decompressed:!1,done:!1,_backtrack:!1,_input:"",_more:!1,_signaled_error_token:!1,conditionStack:[],match:"",matched:"",matches:!1,yytext:"",offset:0,yyleng:0,yylineno:0,yylloc:null,constructLexErrorInfo:function(t,e,r){if(t=""+t,null==r&&(r=!(t.indexOf("\n")>0&&t.indexOf("^")>0)),this.yylloc&&r)if("function"==typeof this.prettyPrintRange){this.prettyPrintRange(this.yylloc);/\n\s*$/.test(t)||(t+="\n"),t+="\n  Erroneous area:\n"+this.prettyPrintRange(this.yylloc)}else if("function"==typeof this.showPosition){var s=this.showPosition();s&&(t.length&&"\n"!==t[t.length-1]&&"\n"!==s[0]?t+="\n"+s:t+=s)}var i={errStr:t,recoverable:!!e,text:this.match,token:null,line:this.yylineno,loc:this.yylloc,yy:this.yy,lexer:this,destroy:function(){var t=!!this.recoverable;for(var e in this)this.hasOwnProperty(e)&&"object"==typeof e&&(this[e]=void 0);this.recoverable=t}};return this.__error_infos.push(i),i},parseError:function(t,e,r){if(r||(r=this.JisonLexerError),this.yy){if(this.yy.parser&&"function"==typeof this.yy.parser.parseError)return this.yy.parser.parseError.call(this,t,e,r)||this.ERROR;if("function"==typeof this.yy.parseError)return this.yy.parseError.call(this,t,e,r)||this.ERROR}throw new r(t,e)},yyerror:function(t){var e="";this.yylloc&&(e=" on line "+(this.yylineno+1));var r=this.constructLexErrorInfo("Lexical error"+e+": "+t,this.options.lexerErrorsAreRecoverable),s=Array.prototype.slice.call(arguments,1);return s.length&&(r.extra_error_attributes=s),this.parseError(r.errStr,r,this.JisonLexerError)||this.ERROR},cleanupAfterLex:function(t){if(this.setInput("",{}),!t){for(var e=this.__error_infos.length-1;e>=0;e--){var r=this.__error_infos[e];r&&"function"==typeof r.destroy&&r.destroy()}this.__error_infos.length=0}return this},clear:function(){this.yytext="",this.yyleng=0,this.match="",this.matches=!1,this._more=!1,this._backtrack=!1;var t=this.yylloc?this.yylloc.last_column:0;this.yylloc={first_line:this.yylineno+1,first_column:t,last_line:this.yylineno+1,last_column:t,range:[this.offset,this.offset]}},setInput:function(t,e){if(this.yy=e||this.yy||{},!this.__decompressed){for(var r=this.rules,s=0,i=r.length;s<i;s++){"number"==typeof(p=r[s])&&(r[s]=r[p])}var n=this.conditions;for(var a in n){var o=n[a],l=o.rules,h=(i=l.length,new Array(i+1)),c=new Array(i+1);for(s=0;s<i;s++){var u=l[s],p=r[u];h[s+1]=p,c[s+1]=u}o.rules=c,o.__rule_regexes=h,o.__rule_count=i}this.__decompressed=!0}return this._input=t||"",this.clear(),this._signaled_error_token=!1,this.done=!1,this.yylineno=0,this.matched="",this.conditionStack=["INITIAL"],this.__currentRuleSet__=null,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]},this.offset=0,this},editRemainingInput:function(t,e){var r=t.call(this,this._input,e);return"string"!=typeof r?r&&(this._input=""+r):this._input=r,this},input:function(){if(!this._input)return null;var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=1,r=!1;if("\n"===t)r=!0;else if("\r"===t){r=!0;var s=this._input[1];"\n"===s&&(e++,t+=s,this.yytext+=s,this.yyleng++,this.offset++,this.match+=s,this.matched+=s,this.yylloc.range[1]++)}return r?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,this._input=this._input.slice(e),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);if(this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.yyleng=this.yytext.length,this.offset-=e,this.match=this.match.substr(0,this.match.length-e),this.matched=this.matched.substr(0,this.matched.length-e),r.length>1){this.yylineno-=r.length-1,this.yylloc.last_line=this.yylineno+1;var s=this.match,i=s.split(/(?:\r\n?|\n)/g);1===i.length&&(i=(s=this.matched).split(/(?:\r\n?|\n)/g)),this.yylloc.last_column=i[i.length-1].length}else this.yylloc.last_column-=e;return this.yylloc.range[1]=this.yylloc.range[0]+this.yyleng,this.done=!1,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else{var t="";this.yylloc&&(t=" on line "+(this.yylineno+1));var e=this.constructLexErrorInfo("Lexical error"+t+": You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).",!1);this._signaled_error_token=this.parseError(e.errStr,e,this.JisonLexerError)||this.ERROR}return this},less:function(t){return this.unput(this.match.slice(t))},pastInput:function(t,e){var r=this.matched.substring(0,this.matched.length-this.match.length);t<0?t=r.length:t||(t=20),e<0?e=r.length:e||(e=1);var s=(r=r.substr(2*-t-2)).replace(/\r\n|\r/g,"\n").split("\n");return(r=(s=s.slice(-e)).join("\n")).length>t&&(r="..."+r.substr(-t)),r},upcomingInput:function(t,e){var r=this.match;t<0?t=r.length+this._input.length:t||(t=20),e<0?e=t:e||(e=1),r.length<2*t+2&&(r+=this._input.substring(0,2*t+2));var s=r.replace(/\r\n|\r/g,"\n").split("\n");return(r=(s=s.slice(0,e)).join("\n")).length>t&&(r=r.substring(0,t)+"..."),r},showPosition:function(t,e){var r=this.pastInput(t).replace(/\s/g," "),s=new Array(r.length+1).join("-");return r+this.upcomingInput(e).replace(/\s/g," ")+"\n"+s+"^"},deriveLocationInfo:function(t,e,r,s){var i={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]};return t&&(i.first_line=0|t.first_line,i.last_line=0|t.last_line,i.first_column=0|t.first_column,i.last_column=0|t.last_column,t.range&&(i.range[0]=0|t.range[0],i.range[1]=0|t.range[1])),(i.first_line<=0||i.last_line<i.first_line)&&(i.first_line<=0&&e&&(i.first_line=0|e.last_line,i.first_column=0|e.last_column,e.range&&(i.range[0]=0|t.range[1])),(i.last_line<=0||i.last_line<i.first_line)&&r&&(i.last_line=0|r.first_line,i.last_column=0|r.first_column,r.range&&(i.range[1]=0|t.range[0])),i.first_line<=0&&s&&(i.last_line<=0||s.last_line<=i.last_line)&&(i.first_line=0|s.first_line,i.first_column=0|s.first_column,s.range&&(i.range[0]=0|s.range[0])),i.last_line<=0&&s&&(i.first_line<=0||s.first_line>=i.first_line)&&(i.last_line=0|s.last_line,i.last_column=0|s.last_column,s.range&&(i.range[1]=0|s.range[1]))),i.last_line<=0&&(i.first_line<=0?(i.first_line=this.yylloc.first_line,i.last_line=this.yylloc.last_line,i.first_column=this.yylloc.first_column,i.last_column=this.yylloc.last_column,i.range[0]=this.yylloc.range[0],i.range[1]=this.yylloc.range[1]):(i.last_line=this.yylloc.last_line,i.last_column=this.yylloc.last_column,i.range[1]=this.yylloc.range[1])),i.first_line<=0&&(i.first_line=i.last_line,i.first_column=0,i.range[1]=i.range[0]),i.first_column<0&&(i.first_column=0),i.last_column<0&&(i.last_column=i.first_column>0?i.first_column:80),i},prettyPrintRange:function(t,e,r){t=this.deriveLocationInfo(t,e,r);for(var s=(this.matched+this._input).split("\n"),i=Math.max(1,e?e.first_line:t.first_line-3),n=Math.max(1,r?r.last_line:t.last_line+1),a=1+Math.log10(1|n)|0,o=new Array(a).join(" "),l=[[],[],[]],h=s.slice(i-1,n+1).map((function(e,r){var s,n=r+i,h=(o+n).substr(-a)+": "+e,c=new Array(a+1).join("^"),u=3,p=0;(n===t.first_line?(u+=t.first_column,p=Math.max(2,(n===t.last_line?t.last_column:e.length)-t.first_column+1)):n===t.last_line?p=Math.max(2,t.last_column+1):n>t.first_line&&n<t.last_line&&(p=Math.max(2,e.length+1)),p)?(h+="\n"+c+new Array(u).join(".")+new Array(p).join("^"),s=1):n<t.first_line?s=0:n>t.last_line&&(s=2);return e.trim().length>0&&l[s].push(r),h=h.replace(/\t/g," ")})),c=0;c<=2;c++){var u=l[c];if(u.length>4){var p=u[1]+1,y=u[u.length-2]-1,_=new Array(a+1).join(" ")+"  (...continued...)";1===c&&(_+="\n"+new Array(a+1).join("-")+"  (---------------)"),h.splice(p,y-p+1,_)}}return h.join("\n")},describeYYLLOC:function(t,e){var r,s=t.first_line,i=t.last_line,n=t.first_column,a=t.last_column;if(0===i-s?(r="line "+s+", ",r+=a-n<=1?"column "+n:"columns "+n+" .. "+a):r="lines "+s+"(column "+n+") .. "+i+"(column "+a+")",t.range&&e){var o=t.range[0],l=t.range[1]-1;r+=l<=o?" {String Offset: "+o+"}":" {String Offset range: "+o+" .. "+l+"}"}return r},test_match:function(t,e){var r,s,i,n,a;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.yylloc.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column,range:this.yylloc.range.slice(0)},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done}),a=(n=t[0]).length,(s=n.split(/(?:\r\n?|\n)/g)).length>1?(this.yylineno+=s.length-1,this.yylloc.last_line=this.yylineno+1,this.yylloc.last_column=s[s.length-1].length):this.yylloc.last_column+=a,this.yytext+=n,this.match+=n,this.matched+=n,this.matches=t,this.yyleng=this.yytext.length,this.yylloc.range[1]+=a,this.offset+=a,this._more=!1,this._backtrack=!1,this._input=this._input.slice(a),r=this.performAction.call(this,this.yy,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in i)this[o]=i[o];return this.__currentRuleSet__=null,!1}return!!this._signaled_error_token&&(r=this._signaled_error_token,this._signaled_error_token=!1,r)},next:function(){if(this.done)return this.clear(),this.EOF;var t,e,r,s;this._input||(this.done=!0),this._more||this.clear();var i=this.__currentRuleSet__;if(!(i||(i=this.__currentRuleSet__=this._currentRules())&&i.rules)){var n="";this.options.trackPosition&&(n=" on line "+(this.yylineno+1));var a=this.constructLexErrorInfo("Internal lexer engine error"+n+': The lex grammar programmer pushed a non-existing condition name "'+this.topState()+'"; this is a fatal error and should be reported to the application programmer team!',!1);return this.parseError(a.errStr,a,this.JisonLexerError)||this.ERROR}for(var o=i.rules,l=i.__rule_regexes,h=i.__rule_count,c=1;c<=h;c++)if((r=this._input.match(l[c]))&&(!e||r[0].length>e[0].length)){if(e=r,s=c,this.options.backtrack_lexer){if(!1!==(t=this.test_match(r,o[c])))return t;if(this._backtrack){e=void 0;continue}return!1}if(!this.options.flex)break}if(e)return!1!==(t=this.test_match(e,o[s]))&&t;if(this._input){n="";this.options.trackPosition&&(n=" on line "+(this.yylineno+1));a=this.constructLexErrorInfo("Lexical error"+n+": Unrecognized text.",this.options.lexerErrorsAreRecoverable);var u=this._input,p=this.topState(),y=this.conditionStack.length;return(t=this.parseError(a.errStr,a,this.JisonLexerError)||this.ERROR)===this.ERROR&&(this.matches||u!==this._input||p!==this.topState()||y!==this.conditionStack.length||this.input()),t}return this.done=!0,this.clear(),this.EOF},lex:function(){var t;for("function"==typeof this.pre_lex&&(t=this.pre_lex.call(this,0)),"function"==typeof this.options.pre_lex&&(t=this.options.pre_lex.call(this,t)||t),this.yy&&"function"==typeof this.yy.pre_lex&&(t=this.yy.pre_lex.call(this,t)||t);!t;)t=this.next();return this.yy&&"function"==typeof this.yy.post_lex&&(t=this.yy.post_lex.call(this,t)||t),"function"==typeof this.options.post_lex&&(t=this.options.post_lex.call(this,t)||t),"function"==typeof this.post_lex&&(t=this.post_lex.call(this,t)||t),t},fastLex:function(){for(var t;!t;)t=this.next();return t},canIUse:function(){return{fastLex:!("function"==typeof this.pre_lex||"function"==typeof this.options.pre_lex||this.yy&&"function"==typeof this.yy.pre_lex||this.yy&&"function"==typeof this.yy.post_lex||"function"==typeof this.options.post_lex||"function"==typeof this.post_lex)&&"function"==typeof this.fastLex}},begin:function(t){return this.pushState(t)},pushState:function(t){return this.conditionStack.push(t),this.__currentRuleSet__=null,this},popState:function(){return this.conditionStack.length-1>0?(this.__currentRuleSet__=null,this.conditionStack.pop()):this.conditionStack[0]},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL},stateStackSize:function(){return this.conditionStack.length},options:{trackPosition:!0,caseInsensitive:!0},JisonLexerError:t,performAction:function(t,e,r){var s=this;switch(e){case 1:
/*! Conditions:: INITIAL */ /*! Rule::       \\{interp} */
return u("matches",this.matches),s.yytext=s.yytext.substring(2,s.yytext.length-1),"INTERPOLATION_WRONG";case 2:
/*! Conditions:: INITIAL */ /*! Rule::       {interp} */
return u("matches",this.matches),s.yytext=s.yytext.substring(2,s.yytext.length-1),9;case 3:
/*! Conditions:: INITIAL */ /*! Rule::       {interp_start}\w+ */this.pushState("INTERP_START");break;case 4:
/*! Conditions:: INTERP_START */ /*! Rule::       . */if("{"==s.yytext)y.push("}");else if("}"==s.yytext&&0!=y.length){if(y.pop()==s.yytext)return 9;throw new Error("Mismatching curly braces")}break;case 9:return u("(?:'#['s*){tag_name}"),s.yytext=this.matches[1],this.pushState("TAG_STARTED"),4;case 10:return s.yytext=this.matches[1],this.pushState("TAG_STARTED"),6;case 12:
/*! Conditions:: TAG_STARTED */ /*! Rule::       \. */
return this.pushState("CLASSNAME_STARTED"),10;case 13:
/*! Conditions:: TAG_STARTED */ /*! Rule::       = */
return this.popState(),this.pushState("ASSIGNMENT_STARTED"),7;case 15:return this.pushState("ASSIGNMENT_STARTED_BRACKET_ADDED"),13;case 16:
/*! Conditions:: ASSIGNMENT_STARTED_BRACKET_ADDED */ /*! Rule::       \] */
return this.popState(),13;case 18:case 33:
/*! Conditions:: BODY_STARTED */ /*! Rule::       \] */
return this.popState(),5;case 19:return this.pushState("BRACKET_ADDED"),12;case 20:return this.pushState("BRACKET_ADDED"),"LBRACKET";case 21:
/*! Conditions:: BRACKET_ADDED */ /*! Rule::       \] */
return this.popState(),"RBRACKET";case 22:return this.pushState("PARENS_ADDED"),"LPAREN";case 23:
/*! Conditions:: PARENS_ADDED */ /*! Rule::       \) */
return this.popState(),"RPAREN";case 25:this.popState(),this.pushState("ATTRS_STARTED");break;case 26:case 30:
/*! Conditions:: ATTRS_STARTED */ /*! Rule::       \) ? */this.popState(),this.pushState("BODY_STARTED");break;case 27:
/*! Conditions:: ATTRS_STARTED */ /*! Rule::       \w+ */
return u("<ATTRS_STARTED>\\w+"),u("yy_.yytext",s.yytext),12;case 35:
/*! Conditions:: CLASSNAME_STARTED */ /*! Rule::       {classname} */
return this.popState(),14;default:return this.simpleCaseActionClusters[e]}},simpleCaseActionClusters:{
/*! Conditions:: INITIAL */ /*! Rule::       \\#\{ */0:"BACKSLASH",
/*! Conditions:: INITIAL */ /*! Rule::       .+\\#\{.+\} */5:8,
/*! Conditions:: INITIAL */ /*! Rule::       #\{.+\} */6:9,
/*! Conditions:: INITIAL */ /*! Rule::       .*\\# */7:8,
/*! Conditions:: INITIAL */ /*! Rule::       {interp} */8:9,
/*! Conditions:: INITIAL */ /*! Rule::       (\w|{space}|[^#])+ */11:8,
/*! Conditions:: ASSIGNMENT_STARTED */ /*! Rule::       [ '] */14:13,
/*! Conditions:: ASSIGNMENT_STARTED ASSIGNMENT_STARTED_BRACKET_ADDED */ /*! Rule::       \w+ */17:13,
/*! Conditions:: TAG_STARTED */ /*! Rule::       \] */24:5,
/*! Conditions:: ATTRS_STARTED */ /*! Rule::       {space}+ */28:12,
/*! Conditions:: ATTRS_STARTED */ /*! Rule::       [^()\]]+ */29:12,
/*! Conditions:: BODY_STARTED ATTRS_STARTED */ /*! Rule::       \w+ */31:11,
/*! Conditions:: BODY_STARTED ATTRS_STARTED */ /*! Rule::       {space}+ */32:11,
/*! Conditions:: BODY_STARTED */ /*! Rule::       .+ */34:11,
/*! Conditions:: INITIAL */ /*! Rule::       # */36:8,
/*! Conditions:: INITIAL */ /*! Rule::       $ */37:1},rules:[/^(?:\\#\{)/i,/^(?:\\(#\{(.+)\}))/i,/^(?:(#\{(.+)\}))/i,/^(?:(#\{)\w+)/i,/^(?:.)/i,/^(?:.+\\#\{.+\})/i,/^(?:#\{.+\})/i,/^(?:.*\\#)/i,/^(?:(#\{(.+)\}))/i,/^(?:(?:#\[\s*)((a|abbr|acronym|address|applet|area|article|aside|audio|b|base|basefont|bdi|bdo|bgsound|big|blink|blockquote|body|br|button|canvas|caption|center|cite|code|col|colgroup|content|data|datalist|dd|del|details|dfn|dialog|dir|div|dl|dt|em|embed|fieldset|figcaption|figure|font|foo|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hgroup|hr|html|i|iframe|image|img|input|ins|kbd|keygen|label|legend|li|link|main|map|mark|marquee|math|menu|menuitem|meta|meter|nav|nobr|noembed|noframes|noscript|object|ol|optgroup|option|output|p|param|picture|plaintext|portal|pre|progress|q|rb|rp|rt|rtc|ruby|s|samp|section|select|shadow|slot|small|source|spacer|span|strike|strong|sub|summary|sup|svg|table|tbody|td|template|textarea|tfoot|th|thead|time|title|tr|track|tt|u|ul|var|video|wbr|xmp)\b))/i,/^(?:(?:#\[\s*):((cdata)\b))/i,/^(?:(\w|([   -​\u2028\u2029　])|[^#])+)/i,/^(?:\.)/i,/^(?:=)/i,/^(?:[ '])/i,/^(?:\[)/i,/^(?:\])/i,/^(?:\w+)/i,/^(?:\])/i,/^(?:\[)/i,/^(?:\[)/i,/^(?:\])/i,/^(?:\()/i,/^(?:\))/i,/^(?:\])/i,/^(?:\()/i,/^(?:([   -​\u2028\u2029　]))/i,/^(?:\w+)/i,/^(?:([   -​\u2028\u2029　])+)/i,/^(?:[^()\]]+)/i,/^(?:\) ?)/i,/^(?:\w+)/i,/^(?:([   -​\u2028\u2029　])+)/i,/^(?:\])/i,/^(?:.+)/i,/^(?:([^\W\d]+[\w\-]*))/i,/^(?:#)/i,/^(?:$)/i],conditions:{AFTER_TAG_START:{rules:[],inclusive:!1},AFTER_TAG_START_END:{rules:[],inclusive:!1},ASSIGNMENT_STARTED:{rules:[14,15,17,18],inclusive:!1},INITIAL:{rules:[0,1,2,3,5,6,7,8,9,10,11,36,37],inclusive:!0},INTERP_START:{rules:[4],inclusive:!1},TAG_STARTED:{rules:[12,13,19,20,24,25,26],inclusive:!1},ASSIGNMENT_STARTED_BRACKET_ADDED:{rules:[16,17],inclusive:!1},BODY_STARTED:{rules:[19,20,31,32,33,34],inclusive:!1},BRACKET_ADDED:{rules:[21],inclusive:!1},ATTRS_STARTED:{rules:[22,27,28,29,30,31,32],inclusive:!1},PARENS_ADDED:{rules:[23],inclusive:!1},CLASSNAME_STARTED:{rules:[35],inclusive:!1}}};return e}();h.lexer=c;const u=s("pug-line-lexer:inline");let p=!1;const y=[];function _(){this.yy={}}h.main=function(){function r(r,s,i=!0){p=!1,!1,u(`\nTesting '${r}'...`);var n=h.parse(r);let a;u(r+" ==> ",e.inspect(n,!1,8)),a=i?t.deepEqual:dyp,a.call({},n,s)}p=!1,!1,r("#[a.rho(href='#', class='rho--modifier') with inline link]",[{type:"tag",name:"a",classes:["rho"],attrs:[{name:"href",val:"'#'"},{name:"class",val:"'rho--modifier'"}],val:"with inline link"}]),r("Some text #[a.rho(href='#', class='rho--modifier')]",[{type:"text",val:"Some text "},{type:"tag",name:"a",classes:["rho"],attrs:[{name:"href",val:"'#'"},{name:"class",val:"'rho--modifier'"}],val:""}]),r("Some text #[a.rho(href='#', class='rho--modifier') with inline link]",[{type:"text",val:"Some text "},{type:"tag",name:"a",classes:["rho"],attrs:[{name:"href",val:"'#'"},{name:"class",val:"'rho--modifier'"}],val:"with inline link"}]),r("Written with love by #{author}",[{type:"text",val:"Written with love by "},{type:"interp",val:"author"}]),r("This will be safe: #{theGreat}",[{type:"text",val:"This will be safe: "},{type:"interp",val:"theGreat"}]),r("No escaping for #{'}'}!",[{type:"text",val:"No escaping for "},{type:"interp",val:"'}'"},{type:"text",val:"!"}]),r("Escaping works with \\#{interpolation}",[{type:"text",val:"Escaping works with \\#{interpolation}"}]),r("#[br]",[{type:"tag",name:"br"}]),r("#[strong mighty]",[{type:"tag",name:"strong",val:"mighty"}]),r("A #[strong strongly worded phrase] that cannot be #[em ignored].",[{type:"text",val:"A "},{type:"tag",name:"strong",val:"strongly worded phrase"},{type:"text",val:" that cannot be "},{type:"tag",name:"em",val:"ignored"},{type:"text",val:"."}]),r("This is a very long and boring paragraph that spans multiple lines. Suddenly there is a #[strong strongly worded phrase] that cannot be #[em ignored].",[{type:"text",val:"This is a very long and boring paragraph that spans multiple lines. Suddenly there is a "},{type:"tag",name:"strong",val:"strongly worded phrase"},{type:"text",val:" that cannot be "},{type:"tag",name:"em",val:"ignored"},{type:"text",val:"."}]);try{r("#[strong a}",{}),fail("expected exception")}catch(t){}r("before #[:cdata inside] after",[{type:"text",val:"before "},{type:"filter",name:"cdata",val:"inside"},{type:"text",val:" after"}]),r("bing #[strong foo] bong",[{type:"text",val:"bing "},{type:"tag",name:"strong",val:"foo"},{type:"text",val:" bong"}]),r("bing #[strong foo] #[strong= '[foo]'] bong",[{type:"text",val:"bing "},{type:"tag",name:"strong",val:"foo"},{type:"text",val:" "},{type:"tag",name:"strong",assignment:" '[foo]'"},{type:"text",val:" bong"}]),r("\\#[strong escaped]",[{type:"text",val:"\\#[strong escaped]"}]),r("\\#[#[strong escaped]",[{type:"text",val:"\\#["},{type:"tag",name:"strong",val:"escaped"}])},_.prototype=h,h.Parser=_;var f={parser:h,Parser:_,parse:function(){return h.parse.apply(h,arguments)}};function m(t,e){var r;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonParserError"}),null==t&&(t="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:t}),this.hash=e,e&&e.exception instanceof Error){var s=e.exception;this.message=s.message||t,r=s.stack}r||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):r=new Error(t).stack),r&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:r})}function g(t,e,r){r=r||0;for(var s=0;s<e;s++)this.push(t),t+=r}function d(t,e){for(e+=t=this.length-t;t<e;t++)this.push(this[t])}function v(t){for(var e=[],r=0,s=t.length;r<s;r++){var i=t[r];"function"==typeof i?(r++,i.apply(e,t[r])):e.push(i)}return e}"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(m.prototype,Error.prototype):m.prototype=Object.create(Error.prototype),m.prototype.constructor=m,m.prototype.name="JisonParserError";var b={trace:function(){},JisonParserError:m,yy:{},options:{type:"lalr",hasPartialLrUpgradeOnConflict:!0,errorRecoveryTokenDiscardCount:3,tokenStack:!0,ebnf:!0},symbols_:{$accept:0,$end:1,COMMA:10,EOF:1,EQ:4,NAME:3,PLUS:8,SPACE:9,SPREAD:5,VAL:6,VAR:7,attr:13,attrs:12,attrs_group:15,attrs_group2:16,error:2,start:11,val:14},terminals_:{1:"EOF",2:"error",3:"NAME",4:"EQ",5:"SPREAD",6:"VAL",7:"VAR",8:"PLUS",9:"SPACE",10:"COMMA"},TERROR:2,EOF:1,originalQuoteName:null,originalParseError:null,cleanupAfterParse:null,constructParseErrorInfo:null,yyMergeLocationInfo:null,__reentrant_call_depth:0,__error_infos:[],__error_recovery_infos:[],quoteName:function(t){return'"'+t+'"'},getSymbolName:function(t){if(this.terminals_[t])return this.terminals_[t];var e=this.symbols_;for(var r in e)if(e[r]===t)return r;return null},describeSymbol:function(t){if(t!==this.EOF&&this.terminal_descriptions_&&this.terminal_descriptions_[t])return this.terminal_descriptions_[t];if(t===this.EOF)return"end of input";var e=this.getSymbolName(t);return e?this.quoteName(e):null},collect_expected_token_set:function(t,e){var r=this.TERROR,s=[],i={};if(!e&&this.state_descriptions_&&this.state_descriptions_[t])return[this.state_descriptions_[t]];for(var n in this.table[t])if((n=+n)!==r){var a=e?n:this.describeSymbol(n);a&&!i[a]&&(s.push(a),i[a]=!0)}return s},productions_:function(t){for(var e=[],r=t.pop,s=t.rule,i=0,n=r.length;i<n;i++)e.push([r[i],s[i]]);return e}({pop:v([11,11,g,[12,3],g,[13,3],g,[14,3],15,15,16,16]),rule:v([1,2,3,2,1,3,g,[1,4],d,[5,5]])}),performAction:function(t,e,r){var s=this.yy;s.parser,s.lexer;switch(t){case 0:case 2:case 4:
/*! Production::    attrs : attrs attrs_group2 */this.$=r[e-1];break;case 1:
/*! Production::    start : EOF */case 9:
/*! Production::    val : VAL */case 10:case 12:
/*! Production::    attrs_group : SPACE */case 13:
/*! Production::    attrs_group : COMMA */case 14:
/*! Production::    attrs_group2 : SPACE */case 15:
/*! Production::    attrs_group2 : COMMA */this.$=r[e];break;case 3:
/*! Production::    attrs : attrs attrs_group attr */r[e-2].push(r[e]),this.$=r[e-2];break;case 5:
/*! Production::    attrs : attr */this.$=[r[e]];break;case 6:
/*! Production::    attr : NAME EQ val */x("attr: NAME EQ val: NAME=",r[e-2],", val=",r[e]),this.$={name:r[e-2].trim(),val:r[e]};break;case 7:
/*! Production::    attr : SPREAD */this.$={name:r[e],val:r[e]};break;case 8:
/*! Production::    attr : NAME */x("attr: NAME: $NAME=",r[e]),this.$={name:r[e]};break;case 11:
/*! Production::    val : val PLUS VAR */this.$=r[e-2]+r[e]}},table:function(t){for(var e=[],r=t.len,s=t.symbol,i=t.type,n=t.state,a=t.mode,o=t.goto,l=0,h=r.length;l<h;l++){for(var c=r[l],u={},p=0;p<c;p++){var y=s.shift();switch(i.shift()){case 2:u[y]=[a.shift(),o.shift()];break;case 0:u[y]=n.shift();break;default:u[y]=[3]}}e.push(u)}return e}({len:v([6,1,0,5,0,4,0,0,3,0,5,5,3,d,[9,4],1,0]),symbol:v([1,3,5,11,12,13,1,1,9,10,15,16,1,4,9,10,3,5,13,d,[19,3],9,10,d,[5,5],6,7,14,1,8,9,10,7]),type:v([g,[2,3],g,[0,3],1,d,[7,5],g,[2,6],d,[7,7],d,[13,12]]),state:v([1,3,4,8,9,13,14]),mode:v([g,[1,6],2,1,2,2,d,[6,3],g,[2,9],d,[18,7]]),goto:v([2,5,6,7,10,11,8,12,8,8,5,6,14,12,12,14,14,15,13,13,g,[15,3],16,6,17,6,6,18])}),defaultActions:{2:1,4:5,6:7,7:2,9:4,13:3,15:9,16:10,18:11},parseError:function(t,e,r){if(!e.recoverable)throw"function"==typeof this.trace&&this.trace(t),r||(r=this.JisonParserError),new r(t,e);"function"==typeof this.trace&&this.trace(t),e.destroy()},parse:function(t){var e,r=this,s=new Array(128),i=new Array(128),n=[],a=new Array(128),o=this.table,l=0,h=0,c=(this.TERROR,this.EOF),u=(this.options.errorRecoveryTokenDiscardCount,[0,19]);e=this.__lexer__?this.__lexer__:this.__lexer__=Object.create(this.lexer);var p,y,_,f,m={parseError:void 0,quoteName:void 0,lexer:void 0,parser:void 0,pre_parse:void 0,post_parse:void 0,pre_lex:void 0,post_lex:void 0};function g(){var t;return"number"!=typeof(t=n.pop()||e.lex()||c)&&(t instanceof Array&&(t=(n=t).pop()),"number"!=typeof t&&(t=r.symbols_[t]||t)),t||c}this.yyGetSharedState=function(){return m},function(t,e){for(var r in e)void 0===t[r]&&Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}(m,this.yy),m.lexer=e,m.parser=this,"function"==typeof m.parseError?this.parseError=function(t,e,r){return r||(r=this.JisonParserError),m.parseError.call(this,t,e,r)}:this.parseError=this.originalParseError,"function"==typeof m.quoteName?this.quoteName=function(t){return m.quoteName.call(this,t)}:this.quoteName=this.originalQuoteName,this.cleanupAfterParse=function(t,r,n){var o,h;r&&((m.post_parse||this.post_parse)&&(h=this.constructParseErrorInfo(null,null,null,!1)),m.post_parse&&void 0!==(o=m.post_parse.call(this,m,t,h))&&(t=o),this.post_parse&&void 0!==(o=this.post_parse.call(this,m,t,h))&&(t=o),h&&h.destroy&&h.destroy());if(this.__reentrant_call_depth>1)return t;if(e.cleanupAfterLex&&e.cleanupAfterLex(n),m&&(m.lexer=void 0,m.parser=void 0,e.yy===m&&(e.yy=void 0)),m=void 0,this.parseError=this.originalParseError,this.quoteName=this.originalQuoteName,s.length=0,i.length=0,a.length=0,l=0,!n){for(var c=this.__error_infos.length-1;c>=0;c--){var u=this.__error_infos[c];u&&"function"==typeof u.destroy&&u.destroy()}this.__error_infos.length=0}return t},this.constructParseErrorInfo=function(t,r,n,o){var c={errStr:t,exception:r,text:e.match,value:e.yytext,token:this.describeSymbol(h)||h,token_id:h,line:e.yylineno,expected:n,recoverable:o,state:p,action:y,new_state:E,symbol_stack:s,state_stack:i,value_stack:a,stack_pointer:l,yy:m,lexer:e,parser:this,destroy:function(){var t=!!this.recoverable;for(var e in this)this.hasOwnProperty(e)&&"object"==typeof e&&(this[e]=void 0);this.recoverable=t}};return this.__error_infos.push(c),c};var d,v,b,E,x={$:!0,_$:void 0,yy:m},T=!1;try{if(this.__reentrant_call_depth++,e.setInput(t,m),"function"==typeof e.canIUse)e.canIUse().fastLex&&"function"==typeof fastLex&&(g=fastLex);for(a[l]=null,i[l]=0,s[l]=0,++l,this.pre_parse&&this.pre_parse.call(this,m),m.pre_parse&&m.pre_parse.call(this,m),E=i[l-1];;){if(p=E,this.defaultActions[p])y=2,E=this.defaultActions[p];else if(h||(h=g()),f=o[p]&&o[p][h]||u,E=f[1],!(y=f[0])){var A,S=this.describeSymbol(h)||h,k=this.collect_expected_token_set(p);A="number"==typeof e.yylineno?"Parse error on line "+(e.yylineno+1)+": ":"Parse error: ","function"==typeof e.showPosition&&(A+="\n"+e.showPosition(69,10)+"\n"),k.length?A+="Expecting "+k.join(", ")+", got unexpected "+S:A+="Unexpected "+S,d=this.constructParseErrorInfo(A,null,k,!1),void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_);break}switch(y){default:if(y instanceof Array){d=this.constructParseErrorInfo("Parse Error: multiple actions possible at state: "+p+", token: "+h,null,null,!1),void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_);break}d=this.constructParseErrorInfo("Parsing halted. No viable error recovery approach available due to internal system failure.",null,null,!1),void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_);break;case 1:s[l]=h,a[l]=e.yytext,i[l]=E,++l,h=0;continue;case 2:if(v=(b=this.productions_[E-1])[1],void 0!==(_=this.performAction.call(x,E,l-1,a))){T=_;break}l-=v;var R=b[0];s[l]=R,a[l]=x.$,E=o[i[l-1]][R],i[l]=E,++l;continue;case 3:-2!==l&&(T=!0,l--,void 0!==a[l]&&(T=a[l]))}break}}catch(t){if(t instanceof this.JisonParserError)throw t;if(e&&"function"==typeof e.JisonLexerError&&t instanceof e.JisonLexerError)throw t;d=this.constructParseErrorInfo("Parsing aborted due to exception.",t,null,!1),T=!1,void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_)}finally{T=this.cleanupAfterParse(T,!0,!0),this.__reentrant_call_depth--}return T}};b.originalParseError=b.parseError,b.originalQuoteName=b.quoteName;var E=function(){function t(t,e){var r;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonLexerError"}),null==t&&(t="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:t}),this.hash=e,e&&e.exception instanceof Error){var s=e.exception;this.message=s.message||t,r=s.stack}r||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):r=new Error(t).stack),r&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:r})}"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(t.prototype,Error.prototype):t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t.prototype.name="JisonLexerError";var e={EOF:1,ERROR:2,__currentRuleSet__:null,__error_infos:[],__decompressed:!1,done:!1,_backtrack:!1,_input:"",_more:!1,_signaled_error_token:!1,conditionStack:[],match:"",matched:"",matches:!1,yytext:"",offset:0,yyleng:0,yylineno:0,yylloc:null,constructLexErrorInfo:function(t,e,r){if(t=""+t,null==r&&(r=!(t.indexOf("\n")>0&&t.indexOf("^")>0)),this.yylloc&&r)if("function"==typeof this.prettyPrintRange){this.prettyPrintRange(this.yylloc);/\n\s*$/.test(t)||(t+="\n"),t+="\n  Erroneous area:\n"+this.prettyPrintRange(this.yylloc)}else if("function"==typeof this.showPosition){var s=this.showPosition();s&&(t.length&&"\n"!==t[t.length-1]&&"\n"!==s[0]?t+="\n"+s:t+=s)}var i={errStr:t,recoverable:!!e,text:this.match,token:null,line:this.yylineno,loc:this.yylloc,yy:this.yy,lexer:this,destroy:function(){var t=!!this.recoverable;for(var e in this)this.hasOwnProperty(e)&&"object"==typeof e&&(this[e]=void 0);this.recoverable=t}};return this.__error_infos.push(i),i},parseError:function(t,e,r){if(r||(r=this.JisonLexerError),this.yy){if(this.yy.parser&&"function"==typeof this.yy.parser.parseError)return this.yy.parser.parseError.call(this,t,e,r)||this.ERROR;if("function"==typeof this.yy.parseError)return this.yy.parseError.call(this,t,e,r)||this.ERROR}throw new r(t,e)},yyerror:function(t){var e="";this.yylloc&&(e=" on line "+(this.yylineno+1));var r=this.constructLexErrorInfo("Lexical error"+e+": "+t,this.options.lexerErrorsAreRecoverable),s=Array.prototype.slice.call(arguments,1);return s.length&&(r.extra_error_attributes=s),this.parseError(r.errStr,r,this.JisonLexerError)||this.ERROR},cleanupAfterLex:function(t){if(this.setInput("",{}),!t){for(var e=this.__error_infos.length-1;e>=0;e--){var r=this.__error_infos[e];r&&"function"==typeof r.destroy&&r.destroy()}this.__error_infos.length=0}return this},clear:function(){this.yytext="",this.yyleng=0,this.match="",this.matches=!1,this._more=!1,this._backtrack=!1;var t=this.yylloc?this.yylloc.last_column:0;this.yylloc={first_line:this.yylineno+1,first_column:t,last_line:this.yylineno+1,last_column:t,range:[this.offset,this.offset]}},setInput:function(t,e){if(this.yy=e||this.yy||{},!this.__decompressed){for(var r=this.rules,s=0,i=r.length;s<i;s++){"number"==typeof(p=r[s])&&(r[s]=r[p])}var n=this.conditions;for(var a in n){var o=n[a],l=o.rules,h=(i=l.length,new Array(i+1)),c=new Array(i+1);for(s=0;s<i;s++){var u=l[s],p=r[u];h[s+1]=p,c[s+1]=u}o.rules=c,o.__rule_regexes=h,o.__rule_count=i}this.__decompressed=!0}return this._input=t||"",this.clear(),this._signaled_error_token=!1,this.done=!1,this.yylineno=0,this.matched="",this.conditionStack=["INITIAL"],this.__currentRuleSet__=null,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]},this.offset=0,this},editRemainingInput:function(t,e){var r=t.call(this,this._input,e);return"string"!=typeof r?r&&(this._input=""+r):this._input=r,this},input:function(){if(!this._input)return null;var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=1,r=!1;if("\n"===t)r=!0;else if("\r"===t){r=!0;var s=this._input[1];"\n"===s&&(e++,t+=s,this.yytext+=s,this.yyleng++,this.offset++,this.match+=s,this.matched+=s,this.yylloc.range[1]++)}return r?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,this._input=this._input.slice(e),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);if(this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.yyleng=this.yytext.length,this.offset-=e,this.match=this.match.substr(0,this.match.length-e),this.matched=this.matched.substr(0,this.matched.length-e),r.length>1){this.yylineno-=r.length-1,this.yylloc.last_line=this.yylineno+1;var s=this.match,i=s.split(/(?:\r\n?|\n)/g);1===i.length&&(i=(s=this.matched).split(/(?:\r\n?|\n)/g)),this.yylloc.last_column=i[i.length-1].length}else this.yylloc.last_column-=e;return this.yylloc.range[1]=this.yylloc.range[0]+this.yyleng,this.done=!1,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else{var t="";this.yylloc&&(t=" on line "+(this.yylineno+1));var e=this.constructLexErrorInfo("Lexical error"+t+": You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).",!1);this._signaled_error_token=this.parseError(e.errStr,e,this.JisonLexerError)||this.ERROR}return this},less:function(t){return this.unput(this.match.slice(t))},pastInput:function(t,e){var r=this.matched.substring(0,this.matched.length-this.match.length);t<0?t=r.length:t||(t=20),e<0?e=r.length:e||(e=1);var s=(r=r.substr(2*-t-2)).replace(/\r\n|\r/g,"\n").split("\n");return(r=(s=s.slice(-e)).join("\n")).length>t&&(r="..."+r.substr(-t)),r},upcomingInput:function(t,e){var r=this.match;t<0?t=r.length+this._input.length:t||(t=20),e<0?e=t:e||(e=1),r.length<2*t+2&&(r+=this._input.substring(0,2*t+2));var s=r.replace(/\r\n|\r/g,"\n").split("\n");return(r=(s=s.slice(0,e)).join("\n")).length>t&&(r=r.substring(0,t)+"..."),r},showPosition:function(t,e){var r=this.pastInput(t).replace(/\s/g," "),s=new Array(r.length+1).join("-");return r+this.upcomingInput(e).replace(/\s/g," ")+"\n"+s+"^"},deriveLocationInfo:function(t,e,r,s){var i={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]};return t&&(i.first_line=0|t.first_line,i.last_line=0|t.last_line,i.first_column=0|t.first_column,i.last_column=0|t.last_column,t.range&&(i.range[0]=0|t.range[0],i.range[1]=0|t.range[1])),(i.first_line<=0||i.last_line<i.first_line)&&(i.first_line<=0&&e&&(i.first_line=0|e.last_line,i.first_column=0|e.last_column,e.range&&(i.range[0]=0|t.range[1])),(i.last_line<=0||i.last_line<i.first_line)&&r&&(i.last_line=0|r.first_line,i.last_column=0|r.first_column,r.range&&(i.range[1]=0|t.range[0])),i.first_line<=0&&s&&(i.last_line<=0||s.last_line<=i.last_line)&&(i.first_line=0|s.first_line,i.first_column=0|s.first_column,s.range&&(i.range[0]=0|s.range[0])),i.last_line<=0&&s&&(i.first_line<=0||s.first_line>=i.first_line)&&(i.last_line=0|s.last_line,i.last_column=0|s.last_column,s.range&&(i.range[1]=0|s.range[1]))),i.last_line<=0&&(i.first_line<=0?(i.first_line=this.yylloc.first_line,i.last_line=this.yylloc.last_line,i.first_column=this.yylloc.first_column,i.last_column=this.yylloc.last_column,i.range[0]=this.yylloc.range[0],i.range[1]=this.yylloc.range[1]):(i.last_line=this.yylloc.last_line,i.last_column=this.yylloc.last_column,i.range[1]=this.yylloc.range[1])),i.first_line<=0&&(i.first_line=i.last_line,i.first_column=0,i.range[1]=i.range[0]),i.first_column<0&&(i.first_column=0),i.last_column<0&&(i.last_column=i.first_column>0?i.first_column:80),i},prettyPrintRange:function(t,e,r){t=this.deriveLocationInfo(t,e,r);for(var s=(this.matched+this._input).split("\n"),i=Math.max(1,e?e.first_line:t.first_line-3),n=Math.max(1,r?r.last_line:t.last_line+1),a=1+Math.log10(1|n)|0,o=new Array(a).join(" "),l=[[],[],[]],h=s.slice(i-1,n+1).map((function(e,r){var s,n=r+i,h=(o+n).substr(-a)+": "+e,c=new Array(a+1).join("^"),u=3,p=0;(n===t.first_line?(u+=t.first_column,p=Math.max(2,(n===t.last_line?t.last_column:e.length)-t.first_column+1)):n===t.last_line?p=Math.max(2,t.last_column+1):n>t.first_line&&n<t.last_line&&(p=Math.max(2,e.length+1)),p)?(h+="\n"+c+new Array(u).join(".")+new Array(p).join("^"),s=1):n<t.first_line?s=0:n>t.last_line&&(s=2);return e.trim().length>0&&l[s].push(r),h=h.replace(/\t/g," ")})),c=0;c<=2;c++){var u=l[c];if(u.length>4){var p=u[1]+1,y=u[u.length-2]-1,_=new Array(a+1).join(" ")+"  (...continued...)";1===c&&(_+="\n"+new Array(a+1).join("-")+"  (---------------)"),h.splice(p,y-p+1,_)}}return h.join("\n")},describeYYLLOC:function(t,e){var r,s=t.first_line,i=t.last_line,n=t.first_column,a=t.last_column;if(0===i-s?(r="line "+s+", ",r+=a-n<=1?"column "+n:"columns "+n+" .. "+a):r="lines "+s+"(column "+n+") .. "+i+"(column "+a+")",t.range&&e){var o=t.range[0],l=t.range[1]-1;r+=l<=o?" {String Offset: "+o+"}":" {String Offset range: "+o+" .. "+l+"}"}return r},test_match:function(t,e){var r,s,i,n,a;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.yylloc.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column,range:this.yylloc.range.slice(0)},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done}),a=(n=t[0]).length,(s=n.split(/(?:\r\n?|\n)/g)).length>1?(this.yylineno+=s.length-1,this.yylloc.last_line=this.yylineno+1,this.yylloc.last_column=s[s.length-1].length):this.yylloc.last_column+=a,this.yytext+=n,this.match+=n,this.matched+=n,this.matches=t,this.yyleng=this.yytext.length,this.yylloc.range[1]+=a,this.offset+=a,this._more=!1,this._backtrack=!1,this._input=this._input.slice(a),r=this.performAction.call(this,this.yy,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in i)this[o]=i[o];return this.__currentRuleSet__=null,!1}return!!this._signaled_error_token&&(r=this._signaled_error_token,this._signaled_error_token=!1,r)},next:function(){if(this.done)return this.clear(),this.EOF;var t,e,r,s;this._input||(this.done=!0),this._more||this.clear();var i=this.__currentRuleSet__;if(!(i||(i=this.__currentRuleSet__=this._currentRules())&&i.rules)){var n="";this.options.trackPosition&&(n=" on line "+(this.yylineno+1));var a=this.constructLexErrorInfo("Internal lexer engine error"+n+': The lex grammar programmer pushed a non-existing condition name "'+this.topState()+'"; this is a fatal error and should be reported to the application programmer team!',!1);return this.parseError(a.errStr,a,this.JisonLexerError)||this.ERROR}for(var o=i.rules,l=i.__rule_regexes,h=i.__rule_count,c=1;c<=h;c++)if((r=this._input.match(l[c]))&&(!e||r[0].length>e[0].length)){if(e=r,s=c,this.options.backtrack_lexer){if(!1!==(t=this.test_match(r,o[c])))return t;if(this._backtrack){e=void 0;continue}return!1}if(!this.options.flex)break}if(e)return!1!==(t=this.test_match(e,o[s]))&&t;if(this._input){n="";this.options.trackPosition&&(n=" on line "+(this.yylineno+1));a=this.constructLexErrorInfo("Lexical error"+n+": Unrecognized text.",this.options.lexerErrorsAreRecoverable);var u=this._input,p=this.topState(),y=this.conditionStack.length;return(t=this.parseError(a.errStr,a,this.JisonLexerError)||this.ERROR)===this.ERROR&&(this.matches||u!==this._input||p!==this.topState()||y!==this.conditionStack.length||this.input()),t}return this.done=!0,this.clear(),this.EOF},lex:function(){var t;for("function"==typeof this.pre_lex&&(t=this.pre_lex.call(this,0)),"function"==typeof this.options.pre_lex&&(t=this.options.pre_lex.call(this,t)||t),this.yy&&"function"==typeof this.yy.pre_lex&&(t=this.yy.pre_lex.call(this,t)||t);!t;)t=this.next();return this.yy&&"function"==typeof this.yy.post_lex&&(t=this.yy.post_lex.call(this,t)||t),"function"==typeof this.options.post_lex&&(t=this.options.post_lex.call(this,t)||t),"function"==typeof this.post_lex&&(t=this.post_lex.call(this,t)||t),t},fastLex:function(){for(var t;!t;)t=this.next();return t},canIUse:function(){return{fastLex:!("function"==typeof this.pre_lex||"function"==typeof this.options.pre_lex||this.yy&&"function"==typeof this.yy.pre_lex||this.yy&&"function"==typeof this.yy.post_lex||"function"==typeof this.options.post_lex||"function"==typeof this.post_lex)&&"function"==typeof this.fastLex}},begin:function(t){return this.pushState(t)},pushState:function(t){return this.conditionStack.push(t),this.__currentRuleSet__=null,this},popState:function(){return this.conditionStack.length-1>0?(this.__currentRuleSet__=null,this.conditionStack.pop()):this.conditionStack[0]},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL},stateStackSize:function(){return this.conditionStack.length},options:{trackPosition:!0},JisonLexerError:t,performAction:function(t,e,r){var s=this;switch(e){case 1:
/*! Conditions:: INITIAL */ /*! Rule::       \.\.\.\w+ */
return x("spread"),5;case 3:
/*! Conditions:: INITIAL */ /*! Rule::       \s*[^= ,]+ */
return this.pushState("AFTER_NAME"),3;case 4:
/*! Conditions:: AFTER_NAME */ /*! Rule::       \s*=\s* */
return this.popState(),this.pushState("AFTER_EQ"),4;case 5:case 6:case 7:case 10:case 15:
/*! Conditions:: AFTER_EQ */ /*! Rule::       .+ */
return this.popState(),6;case 8:case 9:
/*! Conditions:: AFTER_EQ */ /*! Rule::       '([^']|\\')+' */
return this.popState(),this.pushState("VARS"),7;case 11:
/*! Conditions:: AFTER_EQ */ /*! Rule::       [^=]+=(?!>) */x("<AFTER_EQ>[^=]+'='"),x("1 yy_.yytext=",s.yytext);const t=function(t){let e=t.length-2,r=-1;for(;-1==r&&e>-1;){const s=t.charAt(e);/\w/.test(s)&&(r=e),e--}const s=t.substring(0,r);return Math.max(s.lastIndexOf(" "),s.lastIndexOf(","))}(s.yytext);x("lastSepIndex=",t),x("yy_.yytext.length=",s.yytext.length);const r=s.yytext.substring(t);return x("nextToken=",r),this.unput(r),s.yytext=s.yytext.substring(0,t),s.yytext=s.yytext.removeFromEnd(" "),s.yytext=s.yytext.removeFromEnd(","),x("2 yy_.yytext="+s.yytext),this.popState(),this.popState(),6;case 12:
/*! Conditions:: VARS */ /*! Rule::       \s*\+\s*\w+ */return["VAR","PLUS"];case 13:
/*! Conditions:: VARS */ /*! Rule::       ,\s* */
return this.popState(),10;case 14:
/*! Conditions:: VARS */ /*! Rule::       {space} */
return this.popState(),9;case 16:
/*! Conditions:: AFTER_NAME */ /*! Rule::       ,{space}* */
return x("<AFTER_NAME>','"),this.popState(),10;case 17:
/*! Conditions:: AFTER_NAME */ /*! Rule::       {space} */
return x("<AFTER_NAME>{space}"),this.popState(),9;default:return this.simpleCaseActionClusters[e]}},simpleCaseActionClusters:{
/*! Conditions:: INITIAL */ /*! Rule::       ,\s* */0:10,
/*! Conditions:: INITIAL */ /*! Rule::       {space} */2:9},rules:[/^(?:,\s*)/,/^(?:\.\.\.\w+)/,/^(?:([   -​\u2028\u2029　]))/,/^(?:\s*[^= ,]+)/,/^(?:\s*=\s*)/,/^(?:\[[^\]]+\])/,/^(?:\{[^}]+\})/,/^(?:"[^"]+")/,/^(?:'([^']|\\')+'\s*$)/,/^(?:'([^']|\\')+')/,/^(?:\w+\(\))/,/^(?:[^=]+=(?!>))/,/^(?:\s*\+\s*\w+)/,/^(?:,\s*)/,/^(?:([   -​\u2028\u2029　]))/,/^(?:.+)/,/^(?:,([   -​\u2028\u2029　])*)/,/^(?:([   -​\u2028\u2029　]))/],conditions:{AFTER_NAME:{rules:[4,16,17],inclusive:!1},AFTER_EQ:{rules:[5,6,7,8,9,10,11,15],inclusive:!1},VARS:{rules:[12,13,14],inclusive:!1},INITIAL:{rules:[0,1,2,3],inclusive:!0}}};return e}();b.lexer=E;const x=s("pug-line-lexer:attrs");let T=!1;function A(){this.yy={}}b.main=function(){function r(r,s,i=!0){T=!1,!1,x(`\nTesting '${r}'...`);var n=b.parse(r);let a;x(r+" ==> ",e.inspect(n)),a=i?t.deepEqual:dyp,a.call({},n,s)}T=!1,!1,r("abc,",[{name:"abc"}]),r("foo, bar, baz",[{name:"foo"},{name:"bar"},{name:"baz"}]),r("value='foo' selected",[{name:"value",val:"'foo'"},{name:"selected"}]),r("selected value='bar'",[{name:"selected"},{name:"value",val:"'bar'"}]),r("name='viewport' content='width=device-width'",[{name:"name",val:"'viewport'"},{name:"content",val:"'width=device-width'"}]),r("content='I came across a problem in Internet Explorer (it wasn\\'t a problem with Firefox) when I...'",[{name:"content",val:"'I came across a problem in Internet Explorer (it wasn\\'t a problem with Firefox) when I...'"}]),r("property='og:description' content='I came across a problem in Internet Explorer (it wasn\\'t a problem with Firefox) when I...'",[{name:"property",val:"'og:description'"},{name:"content",val:"'I came across a problem in Internet Explorer (it wasn\\'t a problem with Firefox) when I...'"}]),r("foo=null bar=bar",[{name:"foo",val:"null"},{name:"bar",val:"bar"}]),r("data-epoc=new Date(0)",[{name:"data-epoc",val:"new Date(0)"}]),r('class= (tags || []).map((tag) => tag.replaceAll(" ", "_")).join(" ")',[{name:"class",val:'(tags || []).map((tag) => tag.replaceAll(" ", "_")).join(" ")'}]),r("id=id",[{name:"id",val:"id"}]),r("class=['foo', 'bar', 'baz']",[{name:"class",val:"['foo', 'bar', 'baz']"}]),r("class='bar'",[{name:"class",val:"'bar'"}]),r('data-escaped={message: "Let\'s rock!"}',[{name:"data-escaped",val:'{message: "Let\'s rock!"}'}]),r("data-items=[1,2,3]",[{name:"data-items",val:"[1,2,3]"}]),r("href  =  '/user/' + id, class  =  'button'",[{name:"href",val:"'/user/' + id"},{name:"class",val:"'button'"}]),r("href='/user/' + id, class='button'",[{name:"href",val:"'/user/' + id"},{name:"class",val:"'button'"}]),r("key='answer', value=answer()",[{name:"key",val:"'answer'"},{name:"value",val:"answer()"}]),r("class = ['class1', 'class2']",[{name:"class",val:"['class1', 'class2']"}]),r("href='/user/' + id class='button'",[{name:"href",val:"'/user/' + id"},{name:"class",val:"'button'"}]),r("href  =  '/user/' + id class  =  'button'",[{name:"href",val:"'/user/' + id"},{name:"class",val:"'button'"}]),r("key='answer' value=answer()",[{name:"key",val:"'answer'"},{name:"value",val:"answer()"}]),r("class = ['class1', 'class2']",[{name:"class",val:"['class1', 'class2']"}]),r("class = ['class1', 'class2']",[{name:"class",val:"['class1', 'class2']"}]),r("...object",[{name:"...object",val:"...object"}]),r('...object after="after"',[{name:"...object",val:"...object"},{name:"after",val:'"after"'}]),r('before="before" ...object',[{name:"before",val:'"before"'},{name:"...object",val:"...object"}]),r('before="before" ...object after="after"',[{name:"before",val:'"before"'},{name:"...object",val:"...object"},{name:"after",val:'"after"'}])},A.prototype=b,b.Parser=A;var S={parser:b,Parser:A,parse:function(){return b.parse.apply(b,arguments)}};function k(t,e){var r;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonParserError"}),null==t&&(t="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:t}),this.hash=e,e&&e.exception instanceof Error){var s=e.exception;this.message=s.message||t,r=s.stack}r||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):r=new Error(t).stack),r&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:r})}function R(t,e,r){r=r||0;for(var s=0;s<e;s++)this.push(t),t+=r}function N(t,e){for(e+=t=this.length-t;t<e;t++)this.push(this[t])}function P(t){for(var e=[],r=0,s=t.length;r<s;r++){var i=t[r];"function"==typeof i?(r++,i.apply(e,t[r])):e.push(i)}return e}"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(k.prototype,Error.prototype):k.prototype=Object.create(Error.prototype),k.prototype.constructor=k,k.prototype.name="JisonParserError";var O={trace:function(){},JisonParserError:k,yy:{},options:{type:"lalr",hasPartialLrUpgradeOnConflict:!0,errorRecoveryTokenDiscardCount:3,tokenStack:!0,ebnf:!0},symbols_:{$accept:0,$end:1,ASSIGNMENT:34,ASSIGNMENT_VALUE:33,ATTR_TEXT:31,ATTR_TEXT_CONT:7,ATTR_TEXT_END:6,AT_ATTRS:8,CLASSNAME:12,COMMENT:18,CONDITION:32,CONDITIONAL:26,DOT_END:24,EOF:1,FILTER:30,HTML_COMMENT:9,INTERP_END:29,INTERP_START:27,INTERP_VAL:28,KEYWORD:21,LPAREN:11,MIXIN_CALL:20,MIXIN_PARAMS:13,NESTED_TAG_START:5,PIPE:22,RCURLY:23,RPAREN:14,SPACE:25,TAG:15,TAG_ID:17,TEXT:3,TEXT_TAG:16,UNBUF_CODE:4,UNBUF_CODE_BLOCK:19,UNBUF_CODE_BLOCK_START:10,attrs:40,classnames:41,classnames_repetition_plus:45,error:2,first_token:38,line:36,line_end:42,line_splitter:43,line_start:37,line_start_option:44,start:35,tag_part:39},terminals_:{1:"EOF",2:"error",3:"TEXT",4:"UNBUF_CODE",5:"NESTED_TAG_START",6:"ATTR_TEXT_END",7:"ATTR_TEXT_CONT",8:"AT_ATTRS",9:"HTML_COMMENT",10:"UNBUF_CODE_BLOCK_START",11:"LPAREN",12:"CLASSNAME",13:"MIXIN_PARAMS",14:"RPAREN",15:"TAG",16:"TEXT_TAG",17:"TAG_ID",18:"COMMENT",19:"UNBUF_CODE_BLOCK",20:"MIXIN_CALL",21:"KEYWORD",22:"PIPE",23:"RCURLY",24:"DOT_END",25:"SPACE",26:"CONDITIONAL",27:"INTERP_START",28:"INTERP_VAL",29:"INTERP_END",30:"FILTER",31:"ATTR_TEXT",32:"CONDITION",33:"ASSIGNMENT_VALUE",34:"ASSIGNMENT"},TERROR:2,EOF:1,originalQuoteName:null,originalParseError:null,cleanupAfterParse:null,constructParseErrorInfo:null,yyMergeLocationInfo:null,__reentrant_call_depth:0,__error_infos:[],__error_recovery_infos:[],quoteName:function(t){return'"'+t+'"'},getSymbolName:function(t){if(this.terminals_[t])return this.terminals_[t];var e=this.symbols_;for(var r in e)if(e[r]===t)return r;return null},describeSymbol:function(t){if(t!==this.EOF&&this.terminal_descriptions_&&this.terminal_descriptions_[t])return this.terminal_descriptions_[t];if(t===this.EOF)return"end of input";var e=this.getSymbolName(t);return e?this.quoteName(e):null},collect_expected_token_set:function(t,e){var r=this.TERROR,s=[],i={};if(!e&&this.state_descriptions_&&this.state_descriptions_[t])return[this.state_descriptions_[t]];for(var n in this.table[t])if((n=+n)!==r){var a=e?n:this.describeSymbol(n);a&&!i[a]&&(s.push(a),i[a]=!0)}return s},productions_:function(t){for(var e=[],r=t.pop,s=t.rule,i=0,n=r.length;i<n;i++)e.push([r[i],s[i]]);return e}({pop:P([35,35,R,[36,10],R,[37,9],R,[38,17],R,[39,5],40,40,41,R,[42,6],R,[43,3],44,44,45,45]),rule:P([1,2,1,2,2,3,3,1,N,[8,3],N,[4,3],2,3,4,3,3,4,4,R,[1,15],N,[30,5],2,1,N,[38,3],0,R,[1,8],N,[9,3],2])}),performAction:function(t,e,s){var n=this.yy;n.parser,n.lexer;switch(t){case 0:case 2:
/*! Production::    start : line EOF */
this.$=s[e-1];break;case 1:
/*! Production::    start : EOF */case 3:
/*! Production::    line : line_start */case 13:
/*! Production::    line_start : first_token */case 41:case 57:
/*! Production::    line_start_option : ATTR_TEXT_CONT */this.$=s[e];break;case 4:
/*! Production::    line : line_start TEXT */L("line: line_start TEXT: $line_start=",s[e-1],", $TEXT=",s[e]),this.$=j(s[e-1],{type:"text",val:s[e]});break;case 5:
/*! Production::    line : line_start UNBUF_CODE */this.$=j(s[e-1],{type:"unbuf_code",val:s[e],state:"UNBUF_CODE"});break;case 6:
/*! Production::    line : line_start line_splitter line_end */L("line: line_start line_splitter line_end: $line_start=",s[e-2],", $line_end=",s[e]),null==s[e]?this.$=j(s[e-2],s[e-1]):s[e].hasOwnProperty("type")&&"array"==s[e].type?this.$=j(s[e-2],[s[e-1],{children:s[e].val}]):this.$=j(s[e-2],[s[e-1],s[e]]);break;case 7:
/*! Production::    line : line_start NESTED_TAG_START line */this.$=j(s[e-2],{state:"NESTED",children:[s[e]]});break;case 8:
/*! Production::    line : ATTR_TEXT_END */this.$={type:"attrs_end",val:S.parse(s[e])};break;case 9:
/*! Production::    line : ATTR_TEXT_CONT */this.$={type:"attrs_cont",val:S.parse(s[e]),state:"MULTI_LINE_ATTRS"};break;case 10:if(
/*! Production::    line : line_start AT_ATTRS */L("line: line_start AT_ATTRS: $AT_ATTRS=",s[e]),s[e].includes("{")&&s[e].includes("}")){let t=Function("return ("+s[e].substring(12,s[e].length-1)+")"),r=Object.entries(t());L("entries2=",r);let i=Object.entries(r).map((([t,[e,r]])=>(L("name=",e,"value=",r),{name:e,val:r})));this.$=j(s[e-1],{type:"tag",attrs:i})}else this.$=j(s[e-1],{type:"tag",attrs:[{val:s[e].substring(12,s[e].length-1)}]});break;case 11:if(
/*! Production::    line : HTML_COMMENT */L("$HTML_COMMENT=",s[e]),s[e].includes("#")){let t=M(s[e],this.yy.parser);L("elemsReturned",JSON.stringify(t)),this.$={type:"html_comment",children:t}}else this.$={type:"html_comment",val:s[e]};break;case 12:
/*! Production::    line : UNBUF_CODE_BLOCK_START */this.$={type:"unbuf_code_block",state:"UNBUF_CODE_BLOCK"};break;case 14:
/*! Production::    line_start : first_token tag_part */L("line_start: first_token tag_part"),this.$=j(s[e-1],s[e]);break;case 15:
/*! Production::    line_start : first_token attrs */L("line_start: first_token attrs"),this.$=j(s[e-1],s[e]);break;case 16:if(
/*! Production::    line_start : first_token LPAREN line_start_option */L("line_start: first_token LPAREN ATTR_TEXT_CONT?"),this.$=j(s[e-2],{state:"MULTI_LINE_ATTRS"}),s[e]){L("3 Calling parseAttrs with ",s[e]);try{this.$=j(s[e-2],{attrs_start:S.parse(s[e])})}catch(t){console.error("Could not parse attributes="+s[e],t)}}break;case 17:
/*! Production::    line_start : first_token tag_part LPAREN ATTR_TEXT_CONT */L("line_start: first_token tag_part LPAREN ATTR_TEXT_CONT"),this.$=j(s[e-3],[s[e-2],s[e]]);break;case 18:
/*! Production::    line_start : first_token tag_part attrs */L("line_start: first_token tag_part attrs"),this.$=j(s[e-2],[s[e-1],s[e]]);break;case 19:
/*! Production::    line_start : first_token attrs CLASSNAME */this.$=j(s[e-2],[s[e-1],{attrs:[{name:"class",val:D(s[e])}]}]);break;case 20:
/*! Production::    line_start : first_token tag_part attrs CLASSNAME */L("first_token tag_part attrs CLASSNAME: first_token=",s[e-3],", tag_part=",s[e-2],", attrs=",s[e-1],", CLASSNAME=",s[e]),this.$=j(s[e-3],[s[e-2],s[e-1],{attrs:[{name:"class",val:D(s[e])}]}]);break;case 21:
/*! Production::    line_start : first_token LPAREN MIXIN_PARAMS RPAREN */this.$=j(s[e-3],{params:s[e-1]});break;case 22:
/*! Production::    first_token : TAG */this.$={name:s[e],type:"tag"};break;case 23:
/*! Production::    first_token : TEXT_TAG */this.$={name:s[e],type:"tag",state:"TEXT_START"};break;case 24:
/*! Production::    first_token : CLASSNAME */this.$={type:"tag",attrs:[{name:"class",val:D(s[e])}]};break;case 25:
/*! Production::    first_token : TAG_ID */this.$={type:"tag",id:s[e]};break;case 26:case 52:
/*! Production::    line_end : RPAREN */this.$={type:"text",val:s[e]};break;case 27:
/*! Production::    first_token : COMMENT */this.$={type:"comment",state:"TEXT_START"};break;case 28:
/*! Production::    first_token : UNBUF_CODE */case 51:
/*! Production::    line_end : UNBUF_CODE */this.$={type:"unbuf_code",val:s[e],state:"UNBUF_CODE"};break;case 29:
/*! Production::    first_token : UNBUF_CODE_BLOCK */this.$={type:"unbuf_code",val:s[e],state:"UNBUF_CODE_BLOCK"};break;case 30:
/*! Production::    first_token : MIXIN_CALL */L("MIXIN_CALL=",s[e]),this.$={type:"mixin_call",name:s[e].trim(),state:"MIXIN_CALL"};break;case 31:
/*! Production::    first_token : KEYWORD */this.$={type:s[e]};break;case 32:
/*! Production::    first_token : PIPE */this.$={type:"text"};break;case 33:
/*! Production::    first_token : RCURLY */this.$={type:"block_end"};break;case 34:
/*! Production::    first_token : DOT_END */L("line: DOT_END"),this.$={state:"TEXT_START"};break;case 35:
/*! Production::    first_token : SPACE */this.$={};break;case 36:
/*! Production::    first_token : CONDITIONAL */this.$={type:"conditional",name:s[e]};break;case 37:
/*! Production::    first_token : INTERP_START INTERP_VAL INTERP_END */L("line: INTERP_START INTERP_VAL INTERP_END: $INTERP_VAL=",s[e-1]);const t=$.resolve({name:"anonymous",val:s[e-1].slice(2,-1)});this.$={type:"tag",name:t.val};break;case 38:
/*! Production::    first_token : INTERP_VAL */L("line: INTERP_VAL: $INTERP_VAL=",s[e]),L("AttrResolver=",i);const n=$.resolve({name:"anonymous",val:s[e]});L("AttrResolver returned=",n),this.$={type:"text",val:n.val};break;case 39:
/*! Production::    tag_part : TAG_ID */this.$={id:s[e]};break;case 40:
/*! Production::    tag_part : TAG_ID classnames */this.$=j({id:s[e-1]},s[e]);break;case 42:
/*! Production::    tag_part : classnames TAG_ID */this.$=j({id:s[e]},s[e-1]);break;case 43:
/*! Production::    tag_part : FILTER */this.$={filter:s[e]};break;case 44:
/*! Production::    attrs : LPAREN ATTR_TEXT RPAREN */L("1 Calling parseAttrs with ",s[e-1]),this.$={};try{const t=S.parse(s[e-1].trim());L("attrs=",t),t.forEach((t=>{r.isEmpty(t)||(this.$=j(this.$,{attrs:[t]}))}))}catch(t){console.error("Error parsing "+s[e-1],t)}break;case 45:
/*! Production::    attrs : LPAREN CONDITION RPAREN */L("attrs: LPAREN CONDITION RPAREN"),this.$={condition:s[e-1]};break;case 46:
/*! Production::    classnames : classnames_repetition_plus */let a=s[e].map((t=>({name:"class",val:D(t)})));this.$={type:"tag",attrs:a};break;case 47:
/*! Production::    line_end : %epsilon */
this.$=void 0,L("line_end: <blank>");break;case 48:
/*! Production::    line_end : DOT_END */L("line_end: DOT_END"),this.$={state:"TEXT_START"};break;case 49:
/*! Production::    line_end : ASSIGNMENT_VALUE */this.$={assignment_val:s[e]};break;case 50:if(
/*! Production::    line_end : TEXT */L("line_end: TEXT: $TEXT=",s[e]),s[e].includes("#")){let t=M(s[e],this.yy.parser);L("elemsReturned",t),this.$={children:t}}else this.$={type:"text",val:s[e]};break;case 53:
/*! Production::    line_splitter : SPACE */L("line_splitter: SPACE"),this.$={};break;case 54:
/*! Production::    line_splitter : ASSIGNMENT */this.$={assignment:!0};break;case 55:
/*! Production::    line_splitter : DOT_END */L("line_splitter: DOT_END"),this.$={state:"TEXT_START"};break;case 56:
/*! Production::    line_start_option : %epsilon */this.$=void 0;break;case 58:
/*! Production::    classnames_repetition_plus : CLASSNAME */this.$=[s[e]];break;case 59:
/*! Production::    classnames_repetition_plus : classnames_repetition_plus CLASSNAME */s[e-1].push(s[e]),this.$=s[e-1]}},table:function(t){for(var e=[],r=t.len,s=t.symbol,i=t.type,n=t.state,a=t.mode,o=t.goto,l=0,h=r.length;l<h;l++){for(var c=r[l],u={},p=0;p<c;p++){var y=s.shift();switch(i.shift()){case 2:u[y]=[a.shift(),o.shift()];break;case 0:u[y]=n.shift();break;default:u[y]=[3]}}e.push(u)}return e}({len:P([26,1,0,1,9,R,[0,4],16,R,[0,15],1,R,[0,4],7,24,R,[0,4],10,9,13,12,10,0,11,N,[19,6],R,[0,3],3,N,[49,3],R,[1,3],R,[0,10]]),symbol:P([1,3,4,6,7,9,10,12,R,[15,14,1],R,[35,4,1],R,[1,3],3,4,5,8,24,25,34,43,N,[9,5],11,12,17,24,25,30,34,39,40,41,45,28,N,[17,3],14,24,33,42,N,[60,21],N,[59,4],N,[48,5],N,[58,3],40,N,[10,5],12,N,[10,3],N,[9,4],7,8,13,24,25,31,32,34,44,N,[80,7],N,[23,3],41,45,N,[12,6],N,[91,3],N,[35,5],N,[102,6],34,29,7,31,32,N,[59,9],R,[14,3]]),type:P([R,[2,22],R,[0,4],1,N,[14,10],N,[27,16],N,[24,20],N,[33,12],N,[58,22],N,[22,20],N,[44,11],R,[2,28]]),state:P([1,3,4,9,30,36,37,40,42,45,51,4,9,53,55,60,42]),mode:P([R,[1,23],2,N,[8,8],R,[2,4],N,[8,5],N,[19,3],N,[21,8],N,[48,20],N,[40,5],R,[2,8],N,[9,8],N,[52,4],N,[53,3],N,[22,15],N,[10,17],N,[65,13],R,[1,3]]),goto:P([2,14,16,R,[5,4,1],12,10,R,[11,4,2],R,[18,10,1],3,28,29,31,32,35,33,34,R,[13,5],38,43,39,13,13,41,13,44,R,[47,4,1],46,47,N,[49,21],R,[14,5],52,R,[14,3],R,[15,5],54,R,[15,3],R,[56,4],59,R,[56,4],57,58,56,R,[39,6],43,R,[39,3],R,[41,6],61,R,[41,3],R,[46,6],62,R,[46,4],63,64,57,58,R,[18,5],65,R,[18,3],66,67,68])}),defaultActions:function(t){for(var e={},r=t.idx,s=t.goto,i=0,n=r.length;i<n;i++){e[r[i]]=s[i]}return e}({idx:P([2,R,[5,4,1],R,[10,15,1],R,[26,4,1],R,[32,4,1],41,43,R,[45,7,1],54,55,R,[59,10,1]]),goto:P([1,8,9,11,12,R,[22,15,1],38,2,4,5,10,53,54,55,43,58,6,R,[48,5,1],7,19,16,57,40,42,59,37,17,20,21,44,45])}),parseError:function(t,e,r){if(!e.recoverable)throw"function"==typeof this.trace&&this.trace(t),r||(r=this.JisonParserError),new r(t,e);"function"==typeof this.trace&&this.trace(t),e.destroy()},parse:function(t){var e,r=this,s=new Array(128),i=new Array(128),n=[],a=new Array(128),o=this.table,l=0,h=0,c=(this.TERROR,this.EOF),u=(this.options.errorRecoveryTokenDiscardCount,[0,69]);e=this.__lexer__?this.__lexer__:this.__lexer__=Object.create(this.lexer);var p,y,_,f,m={parseError:void 0,quoteName:void 0,lexer:void 0,parser:void 0,pre_parse:void 0,post_parse:void 0,pre_lex:void 0,post_lex:void 0};function g(){var t;return"number"!=typeof(t=n.pop()||e.lex()||c)&&(t instanceof Array&&(t=(n=t).pop()),"number"!=typeof t&&(t=r.symbols_[t]||t)),t||c}this.yyGetSharedState=function(){return m},function(t,e){for(var r in e)void 0===t[r]&&Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}(m,this.yy),m.lexer=e,m.parser=this,"function"==typeof m.parseError?this.parseError=function(t,e,r){return r||(r=this.JisonParserError),m.parseError.call(this,t,e,r)}:this.parseError=this.originalParseError,"function"==typeof m.quoteName?this.quoteName=function(t){return m.quoteName.call(this,t)}:this.quoteName=this.originalQuoteName,this.cleanupAfterParse=function(t,r,n){var o,h;r&&((m.post_parse||this.post_parse)&&(h=this.constructParseErrorInfo(null,null,null,!1)),m.post_parse&&void 0!==(o=m.post_parse.call(this,m,t,h))&&(t=o),this.post_parse&&void 0!==(o=this.post_parse.call(this,m,t,h))&&(t=o),h&&h.destroy&&h.destroy());if(this.__reentrant_call_depth>1)return t;if(e.cleanupAfterLex&&e.cleanupAfterLex(n),m&&(m.lexer=void 0,m.parser=void 0,e.yy===m&&(e.yy=void 0)),m=void 0,this.parseError=this.originalParseError,this.quoteName=this.originalQuoteName,s.length=0,i.length=0,a.length=0,l=0,!n){for(var c=this.__error_infos.length-1;c>=0;c--){var u=this.__error_infos[c];u&&"function"==typeof u.destroy&&u.destroy()}this.__error_infos.length=0}return t},this.constructParseErrorInfo=function(t,r,n,o){var c={errStr:t,exception:r,text:e.match,value:e.yytext,token:this.describeSymbol(h)||h,token_id:h,line:e.yylineno,expected:n,recoverable:o,state:p,action:y,new_state:E,symbol_stack:s,state_stack:i,value_stack:a,stack_pointer:l,yy:m,lexer:e,parser:this,destroy:function(){var t=!!this.recoverable;for(var e in this)this.hasOwnProperty(e)&&"object"==typeof e&&(this[e]=void 0);this.recoverable=t}};return this.__error_infos.push(c),c};var d,v,b,E,x={$:!0,_$:void 0,yy:m},T=!1;try{if(this.__reentrant_call_depth++,e.setInput(t,m),"function"==typeof e.canIUse)e.canIUse().fastLex&&"function"==typeof fastLex&&(g=fastLex);for(a[l]=null,i[l]=0,s[l]=0,++l,this.pre_parse&&this.pre_parse.call(this,m),m.pre_parse&&m.pre_parse.call(this,m),E=i[l-1];;){if(p=E,this.defaultActions[p])y=2,E=this.defaultActions[p];else if(h||(h=g()),f=o[p]&&o[p][h]||u,E=f[1],!(y=f[0])){var A,S=this.describeSymbol(h)||h,k=this.collect_expected_token_set(p);A="number"==typeof e.yylineno?"Parse error on line "+(e.yylineno+1)+": ":"Parse error: ","function"==typeof e.showPosition&&(A+="\n"+e.showPosition(69,10)+"\n"),k.length?A+="Expecting "+k.join(", ")+", got unexpected "+S:A+="Unexpected "+S,d=this.constructParseErrorInfo(A,null,k,!1),void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_);break}switch(y){default:if(y instanceof Array){d=this.constructParseErrorInfo("Parse Error: multiple actions possible at state: "+p+", token: "+h,null,null,!1),void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_);break}d=this.constructParseErrorInfo("Parsing halted. No viable error recovery approach available due to internal system failure.",null,null,!1),void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_);break;case 1:s[l]=h,a[l]=e.yytext,i[l]=E,++l,h=0;continue;case 2:if(v=(b=this.productions_[E-1])[1],void 0!==(_=this.performAction.call(x,E,l-1,a))){T=_;break}l-=v;var R=b[0];s[l]=R,a[l]=x.$,E=o[i[l-1]][R],i[l]=E,++l;continue;case 3:-2!==l&&(T=!0,l--,void 0!==a[l]&&(T=a[l]))}break}}catch(t){if(t instanceof this.JisonParserError)throw t;if(e&&"function"==typeof e.JisonLexerError&&t instanceof e.JisonLexerError)throw t;d=this.constructParseErrorInfo("Parsing aborted due to exception.",t,null,!1),T=!1,void 0!==(_=this.parseError(d.errStr,d,this.JisonParserError))&&(T=_)}finally{T=this.cleanupAfterParse(T,!0,!0),this.__reentrant_call_depth--}return T}};O.originalParseError=O.parseError,O.originalQuoteName=O.quoteName;var w=function(){function t(t,e){var r;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonLexerError"}),null==t&&(t="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:t}),this.hash=e,e&&e.exception instanceof Error){var s=e.exception;this.message=s.message||t,r=s.stack}r||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):r=new Error(t).stack),r&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:r})}"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(t.prototype,Error.prototype):t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t.prototype.name="JisonLexerError";var e={EOF:1,ERROR:2,__currentRuleSet__:null,__error_infos:[],__decompressed:!1,done:!1,_backtrack:!1,_input:"",_more:!1,_signaled_error_token:!1,conditionStack:[],match:"",matched:"",matches:!1,yytext:"",offset:0,yyleng:0,yylineno:0,yylloc:null,constructLexErrorInfo:function(t,e,r){if(t=""+t,null==r&&(r=!(t.indexOf("\n")>0&&t.indexOf("^")>0)),this.yylloc&&r)if("function"==typeof this.prettyPrintRange){this.prettyPrintRange(this.yylloc);/\n\s*$/.test(t)||(t+="\n"),t+="\n  Erroneous area:\n"+this.prettyPrintRange(this.yylloc)}else if("function"==typeof this.showPosition){var s=this.showPosition();s&&(t.length&&"\n"!==t[t.length-1]&&"\n"!==s[0]?t+="\n"+s:t+=s)}var i={errStr:t,recoverable:!!e,text:this.match,token:null,line:this.yylineno,loc:this.yylloc,yy:this.yy,lexer:this,destroy:function(){var t=!!this.recoverable;for(var e in this)this.hasOwnProperty(e)&&"object"==typeof e&&(this[e]=void 0);this.recoverable=t}};return this.__error_infos.push(i),i},parseError:function(t,e,r){if(r||(r=this.JisonLexerError),this.yy){if(this.yy.parser&&"function"==typeof this.yy.parser.parseError)return this.yy.parser.parseError.call(this,t,e,r)||this.ERROR;if("function"==typeof this.yy.parseError)return this.yy.parseError.call(this,t,e,r)||this.ERROR}throw new r(t,e)},yyerror:function(t){var e="";this.yylloc&&(e=" on line "+(this.yylineno+1));var r=this.constructLexErrorInfo("Lexical error"+e+": "+t,this.options.lexerErrorsAreRecoverable),s=Array.prototype.slice.call(arguments,1);return s.length&&(r.extra_error_attributes=s),this.parseError(r.errStr,r,this.JisonLexerError)||this.ERROR},cleanupAfterLex:function(t){if(this.setInput("",{}),!t){for(var e=this.__error_infos.length-1;e>=0;e--){var r=this.__error_infos[e];r&&"function"==typeof r.destroy&&r.destroy()}this.__error_infos.length=0}return this},clear:function(){this.yytext="",this.yyleng=0,this.match="",this.matches=!1,this._more=!1,this._backtrack=!1;var t=this.yylloc?this.yylloc.last_column:0;this.yylloc={first_line:this.yylineno+1,first_column:t,last_line:this.yylineno+1,last_column:t,range:[this.offset,this.offset]}},setInput:function(t,e){if(this.yy=e||this.yy||{},!this.__decompressed){for(var r=this.rules,s=0,i=r.length;s<i;s++){"number"==typeof(p=r[s])&&(r[s]=r[p])}var n=this.conditions;for(var a in n){var o=n[a],l=o.rules,h=(i=l.length,new Array(i+1)),c=new Array(i+1);for(s=0;s<i;s++){var u=l[s],p=r[u];h[s+1]=p,c[s+1]=u}o.rules=c,o.__rule_regexes=h,o.__rule_count=i}this.__decompressed=!0}return this._input=t||"",this.clear(),this._signaled_error_token=!1,this.done=!1,this.yylineno=0,this.matched="",this.conditionStack=["INITIAL"],this.__currentRuleSet__=null,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]},this.offset=0,this},editRemainingInput:function(t,e){var r=t.call(this,this._input,e);return"string"!=typeof r?r&&(this._input=""+r):this._input=r,this},input:function(){if(!this._input)return null;var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=1,r=!1;if("\n"===t)r=!0;else if("\r"===t){r=!0;var s=this._input[1];"\n"===s&&(e++,t+=s,this.yytext+=s,this.yyleng++,this.offset++,this.match+=s,this.matched+=s,this.yylloc.range[1]++)}return r?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,this._input=this._input.slice(e),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);if(this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.yyleng=this.yytext.length,this.offset-=e,this.match=this.match.substr(0,this.match.length-e),this.matched=this.matched.substr(0,this.matched.length-e),r.length>1){this.yylineno-=r.length-1,this.yylloc.last_line=this.yylineno+1;var s=this.match,i=s.split(/(?:\r\n?|\n)/g);1===i.length&&(i=(s=this.matched).split(/(?:\r\n?|\n)/g)),this.yylloc.last_column=i[i.length-1].length}else this.yylloc.last_column-=e;return this.yylloc.range[1]=this.yylloc.range[0]+this.yyleng,this.done=!1,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else{var t="";this.yylloc&&(t=" on line "+(this.yylineno+1));var e=this.constructLexErrorInfo("Lexical error"+t+": You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).",!1);this._signaled_error_token=this.parseError(e.errStr,e,this.JisonLexerError)||this.ERROR}return this},less:function(t){return this.unput(this.match.slice(t))},pastInput:function(t,e){var r=this.matched.substring(0,this.matched.length-this.match.length);t<0?t=r.length:t||(t=20),e<0?e=r.length:e||(e=1);var s=(r=r.substr(2*-t-2)).replace(/\r\n|\r/g,"\n").split("\n");return(r=(s=s.slice(-e)).join("\n")).length>t&&(r="..."+r.substr(-t)),r},upcomingInput:function(t,e){var r=this.match;t<0?t=r.length+this._input.length:t||(t=20),e<0?e=t:e||(e=1),r.length<2*t+2&&(r+=this._input.substring(0,2*t+2));var s=r.replace(/\r\n|\r/g,"\n").split("\n");return(r=(s=s.slice(0,e)).join("\n")).length>t&&(r=r.substring(0,t)+"..."),r},showPosition:function(t,e){var r=this.pastInput(t).replace(/\s/g," "),s=new Array(r.length+1).join("-");return r+this.upcomingInput(e).replace(/\s/g," ")+"\n"+s+"^"},deriveLocationInfo:function(t,e,r,s){var i={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]};return t&&(i.first_line=0|t.first_line,i.last_line=0|t.last_line,i.first_column=0|t.first_column,i.last_column=0|t.last_column,t.range&&(i.range[0]=0|t.range[0],i.range[1]=0|t.range[1])),(i.first_line<=0||i.last_line<i.first_line)&&(i.first_line<=0&&e&&(i.first_line=0|e.last_line,i.first_column=0|e.last_column,e.range&&(i.range[0]=0|t.range[1])),(i.last_line<=0||i.last_line<i.first_line)&&r&&(i.last_line=0|r.first_line,i.last_column=0|r.first_column,r.range&&(i.range[1]=0|t.range[0])),i.first_line<=0&&s&&(i.last_line<=0||s.last_line<=i.last_line)&&(i.first_line=0|s.first_line,i.first_column=0|s.first_column,s.range&&(i.range[0]=0|s.range[0])),i.last_line<=0&&s&&(i.first_line<=0||s.first_line>=i.first_line)&&(i.last_line=0|s.last_line,i.last_column=0|s.last_column,s.range&&(i.range[1]=0|s.range[1]))),i.last_line<=0&&(i.first_line<=0?(i.first_line=this.yylloc.first_line,i.last_line=this.yylloc.last_line,i.first_column=this.yylloc.first_column,i.last_column=this.yylloc.last_column,i.range[0]=this.yylloc.range[0],i.range[1]=this.yylloc.range[1]):(i.last_line=this.yylloc.last_line,i.last_column=this.yylloc.last_column,i.range[1]=this.yylloc.range[1])),i.first_line<=0&&(i.first_line=i.last_line,i.first_column=0,i.range[1]=i.range[0]),i.first_column<0&&(i.first_column=0),i.last_column<0&&(i.last_column=i.first_column>0?i.first_column:80),i},prettyPrintRange:function(t,e,r){t=this.deriveLocationInfo(t,e,r);for(var s=(this.matched+this._input).split("\n"),i=Math.max(1,e?e.first_line:t.first_line-3),n=Math.max(1,r?r.last_line:t.last_line+1),a=1+Math.log10(1|n)|0,o=new Array(a).join(" "),l=[[],[],[]],h=s.slice(i-1,n+1).map((function(e,r){var s,n=r+i,h=(o+n).substr(-a)+": "+e,c=new Array(a+1).join("^"),u=3,p=0;(n===t.first_line?(u+=t.first_column,p=Math.max(2,(n===t.last_line?t.last_column:e.length)-t.first_column+1)):n===t.last_line?p=Math.max(2,t.last_column+1):n>t.first_line&&n<t.last_line&&(p=Math.max(2,e.length+1)),p)?(h+="\n"+c+new Array(u).join(".")+new Array(p).join("^"),s=1):n<t.first_line?s=0:n>t.last_line&&(s=2);return e.trim().length>0&&l[s].push(r),h=h.replace(/\t/g," ")})),c=0;c<=2;c++){var u=l[c];if(u.length>4){var p=u[1]+1,y=u[u.length-2]-1,_=new Array(a+1).join(" ")+"  (...continued...)";1===c&&(_+="\n"+new Array(a+1).join("-")+"  (---------------)"),h.splice(p,y-p+1,_)}}return h.join("\n")},describeYYLLOC:function(t,e){var r,s=t.first_line,i=t.last_line,n=t.first_column,a=t.last_column;if(0===i-s?(r="line "+s+", ",r+=a-n<=1?"column "+n:"columns "+n+" .. "+a):r="lines "+s+"(column "+n+") .. "+i+"(column "+a+")",t.range&&e){var o=t.range[0],l=t.range[1]-1;r+=l<=o?" {String Offset: "+o+"}":" {String Offset range: "+o+" .. "+l+"}"}return r},test_match:function(t,e){var r,s,i,n,a;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.yylloc.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column,range:this.yylloc.range.slice(0)},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done}),a=(n=t[0]).length,(s=n.split(/(?:\r\n?|\n)/g)).length>1?(this.yylineno+=s.length-1,this.yylloc.last_line=this.yylineno+1,this.yylloc.last_column=s[s.length-1].length):this.yylloc.last_column+=a,this.yytext+=n,this.match+=n,this.matched+=n,this.matches=t,this.yyleng=this.yytext.length,this.yylloc.range[1]+=a,this.offset+=a,this._more=!1,this._backtrack=!1,this._input=this._input.slice(a),r=this.performAction.call(this,this.yy,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in i)this[o]=i[o];return this.__currentRuleSet__=null,!1}return!!this._signaled_error_token&&(r=this._signaled_error_token,this._signaled_error_token=!1,r)},next:function(){if(this.done)return this.clear(),this.EOF;var t,e,r,s;this._input||(this.done=!0),this._more||this.clear();var i=this.__currentRuleSet__;if(!(i||(i=this.__currentRuleSet__=this._currentRules())&&i.rules)){var n="";this.options.trackPosition&&(n=" on line "+(this.yylineno+1));var a=this.constructLexErrorInfo("Internal lexer engine error"+n+': The lex grammar programmer pushed a non-existing condition name "'+this.topState()+'"; this is a fatal error and should be reported to the application programmer team!',!1);return this.parseError(a.errStr,a,this.JisonLexerError)||this.ERROR}for(var o=i.rules,l=i.__rule_regexes,h=i.__rule_count,c=1;c<=h;c++)if((r=this._input.match(l[c]))&&(!e||r[0].length>e[0].length)){if(e=r,s=c,this.options.backtrack_lexer){if(!1!==(t=this.test_match(r,o[c])))return t;if(this._backtrack){e=void 0;continue}return!1}if(!this.options.flex)break}if(e)return!1!==(t=this.test_match(e,o[s]))&&t;if(this._input){n="";this.options.trackPosition&&(n=" on line "+(this.yylineno+1));a=this.constructLexErrorInfo("Lexical error"+n+": Unrecognized text.",this.options.lexerErrorsAreRecoverable);var u=this._input,p=this.topState(),y=this.conditionStack.length;return(t=this.parseError(a.errStr,a,this.JisonLexerError)||this.ERROR)===this.ERROR&&(this.matches||u!==this._input||p!==this.topState()||y!==this.conditionStack.length||this.input()),t}return this.done=!0,this.clear(),this.EOF},lex:function(){var t;for("function"==typeof this.pre_lex&&(t=this.pre_lex.call(this,0)),"function"==typeof this.options.pre_lex&&(t=this.options.pre_lex.call(this,t)||t),this.yy&&"function"==typeof this.yy.pre_lex&&(t=this.yy.pre_lex.call(this,t)||t);!t;)t=this.next();return this.yy&&"function"==typeof this.yy.post_lex&&(t=this.yy.post_lex.call(this,t)||t),"function"==typeof this.options.post_lex&&(t=this.options.post_lex.call(this,t)||t),"function"==typeof this.post_lex&&(t=this.post_lex.call(this,t)||t),t},fastLex:function(){for(var t;!t;)t=this.next();return t},canIUse:function(){return{fastLex:!("function"==typeof this.pre_lex||"function"==typeof this.options.pre_lex||this.yy&&"function"==typeof this.yy.pre_lex||this.yy&&"function"==typeof this.yy.post_lex||"function"==typeof this.options.post_lex||"function"==typeof this.post_lex)&&"function"==typeof this.fastLex}},begin:function(t){return this.pushState(t)},pushState:function(t){return this.conditionStack.push(t),this.__currentRuleSet__=null,this},popState:function(){return this.conditionStack.length-1>0?(this.__currentRuleSet__=null,this.conditionStack.pop()):this.conditionStack[0]},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL},stateStackSize:function(){return this.conditionStack.length},options:{trackPosition:!0,caseInsensitive:!0},JisonLexerError:t,performAction:function(t,e,r){var s=this;switch(e){case 0:return 15;case 1:
/*! Conditions:: INITIAL */ /*! Rule::       {keyword} */
return this.pushState("AFTER_KEYWORD"),21;case 2:
/*! Conditions:: INITIAL */ /*! Rule::       {tag} */
return this.pushState("AFTER_TAG_NAME"),15;case 3:
/*! Conditions:: INITIAL */ /*! Rule::       (script|style) */return I?(this.pushState("AFTER_TAG_NAME"),15):(this.pushState("AFTER_TEXT_TAG_NAME"),16);case 4:
/*! Conditions:: INITIAL */ /*! Rule::       {tag_id} */
return this.pushState("AFTER_TAG_NAME"),s.yytext=s.yytext.substring(1),17;case 5:
/*! Conditions:: INITIAL */ /*! Rule::       {mixin_call} */
return s.yytext=s.yytext.substring(1),this.pushState("MIXIN_CALL_START"),20;case 6:
/*! Conditions:: INITIAL */ /*! Rule::       \} */
return this.pushState("AFTER_KEYWORD"),23;case 7:
/*! Conditions:: INITIAL */ /*! Rule::       {conditional} */
return this.pushState("COND_START"),s.yytext.startsWith("-")&&(s.yytext=s.yytext.substring(1)),26;case 8:return this.pushState("COND_START"),11;case 9:
/*! Conditions:: COND_START */ /*! Rule::       .+\) */
return this.popState(),s.yytext=s.yytext.substring(0,s.yytext.length-1),["RPAREN","CONDITION"];case 11:
/*! Conditions:: INITIAL UNBUF_CODE */ /*! Rule::       - */this.pushState("UNBUF_CODE_START");break;case 12:case 30:
/*! Conditions:: INITIAL ATTRS_END */ /*! Rule::       {classname} */
return this.pushState("AFTER_TAG_NAME"),s.yytext=s.yytext.substring(1),12;case 13:if(
/*! Conditions:: INITIAL */ /*! Rule::       {classname_relaxed} */L("<INITIAL>{classname_relaxed}"),this.yy.parser.options.allowDigitToStartClassName)return this.pushState("AFTER_TAG_NAME"),s.yytext=s.yytext.substring(1),12;throw new Error("Classnames starting with a digit is not allowed. Set allowDigitToStartClassName to true to allow.");case 14:
/*! Conditions:: INITIAL */ /*! Rule::       \/\/ */
return this.pushState("TEXT"),18;case 15:
/*! Conditions:: INITIAL */ /*! Rule::       <[A-Z_]+> */if(!/<[A-Z_]+>/.test(s.yytext))return this.pushState("TEXT"),3;this.pushState(s.yytext.substring(1,s.yytext.length-1));break;case 16:
/*! Conditions:: INITIAL TEXT */ /*! Rule::       \|  */
return this.pushState("TEXT"),22;case 17:
/*! Conditions:: INITIAL */ /*! Rule::       \|\. */this.pushState("TEXT"),this.unput(".");break;case 18:
/*! Conditions:: INITIAL */ /*! Rule::       \|$ */
return this.pushState("TEXT"),s.yytext="",3;case 19:
/*! Conditions:: INITIAL AFTER_TAG_NAME ATTRS_END */ /*! Rule::       &attributes\([^\)]+\) */
return L("'&attributes('[^)]+')'"),8;case 20:
/*! Conditions:: INITIAL */ /*! Rule::       {interpolation} */
return L("{interpolation}"),L("this.matches=",this.matches),this.pushState("AFTER_TAG_NAME"),["INTERP_END","INTERP_VAL","INTERP_START"];case 21:
/*! Conditions:: INTERPOLATION */ /*! Rule::       .+ */
return 28;case 22:
/*! Conditions:: INITIAL */ /*! Rule::       {interpolation_start} */
return L("{interpolation_start}"),L("this.matches=",this.matches),this.pushState("INTERPOLATION_START"),"INTERPOLATION_START";case 23:
/*! Conditions:: INITIAL */ /*! Rule::       <\/.+ */
return this.pushState("TEXT"),3;case 24:case 48:
/*! Conditions:: ATTRS_END */ /*! Rule::       ={space} */
return this.popState(),this.pushState("ASSIGNMENT_VALUE"),34;case 25:
/*! Conditions:: AFTER_TAG_NAME AFTER_ATTRS */ /*! Rule::       :  */
return this.popState(),5;case 26:
/*! Conditions:: AFTER_KEYWORD */ /*! Rule::       {filter} */
return s.yytext=s.yytext.substring(1),30;case 27:return L("<AFTER_TAG_NAME,AFTER_TEXT_TAG_NAME>'('"),this.pushState("ATTRS_STARTED"),11;case 29:
/*! Conditions:: MIXIN_PARAMS_END */ /*! Rule::       \) */
return 14;case 31:if(
/*! Conditions:: INITIAL ATTRS_END */ /*! Rule::       {classname_relaxed} */L("<INITIAL,ATTRS_END>{classname_relaxed}"),this.yy.parser.options.allowDigitToStartClassName)return this.pushState("AFTER_TAG_NAME"),s.yytext=s.yytext.substring(1),12;throw new Error("Classnames starting with a digit is not allowed. Set allowDigitToStartClassName to true to allow.");case 32:L("15 yy_.yytext=",s.yytext),L("15 this.matches=",this.matches);const t=[];let r=0;for(;r<s.yytext.length;r++)if(/[\)\]}]/.test(s.yytext[r])){if(L("match"),L("stack.peek()=",t.peek()),0==t.length||t.pop()!=s.yytext[r]){L("stack.length=",t.length);break}}else switch(s.yytext[r]){case"(":t.push(")");break;case"[":t.push("]");break;case"{":t.push("}")}return this.unput(s.yytext.substring(r)),s.yytext=s.yytext.substring(0,r),L("15 yy_.yytext=",s.yytext),this.popState(),this.pushState("ATTRS_END"),31;case 33:
/*! Conditions:: ATTRS_STARTED */ /*! Rule::       ([^\)]+)(\))(?!\s*\..+\)) */this.popState(),this.pushState("ATTRS_END"),L("20 this.matches=",this.matches),L("20 this.matches.length=",this.matches.length),L("20 yy_.yytext=",s.yytext);try{this.unput(")"),this.matches.length>1&&(s.yytext=this.matches[1])}catch(t){console.error(t)}return!1,L("20 yy_.yytext=",s.yytext),31;case 34:
/*! Conditions:: ATTRS_STARTED */ /*! Rule::       (.+)\)\s*$ */this.popState(),L("30 this.matches=",this.matches),L("30 this.matches.length=",this.matches.length),L("30 yy_.yytext=",s.yytext);try{this.matches.length>1&&(s.yytext=this.matches[1])}catch(t){console.error(t)}return!1,L("30 yy_.yytext=",s.yytext),["RPAREN","ATTR_TEXT"];case 35:
/*! Conditions:: ATTRS_STARTED */ /*! Rule::       (.+)\)\.?\s*(.+)$ */
return this.popState(),this.pushState("ATTRS_END"),L("40 this.matches=",this.matches),this.unput(this.matches[2]),s.yytext=s.yytext.substring(0,s.yytext.indexOf(this.matches[1])+this.matches[1].length),L("40 yy_.yytext=",s.yytext),!1,["RPAREN","ATTR_TEXT"];case 36:
/*! Conditions:: ATTRS_STARTED */ /*! Rule::       (.+)\.?\s*$ */this.popState(),L("50 this.matches=",this.matches),L("50 this.matches.length=",this.matches.length),L("50 yy_.yytext=",s.yytext);try{this.matches.length>1&&(s.yytext=this.matches[1])}catch(t){console.error(t)}return L("50 yy_.yytext=",s.yytext),7;case 37:
/*! Conditions:: AFTER_TAG_NAME */ /*! Rule::       {tag_id} */
return this.pushState("AFTER_TAG_NAME"),s.yytext=this.matches[1].substring(1),17;case 38:
/*! Conditions:: AFTER_TAG_NAME */ /*! Rule::       {classname} */
return s.yytext=s.yytext.substring(1),L("60 yy_.yytext=",s.yytext),12;case 39:
/*! Conditions:: AFTER_TAG_NAME */ /*! Rule::       {classname_relaxed} */
if(this.yy.parser.options.allowDigitToStartClassName)return s.yytext=s.yytext.substring(1),12;throw new Error("Classnames starting with a digit is not allowed. Set allowDigitToStartClassName to true to allow.");case 40:
/*! Conditions:: INITIAL */ /*! Rule::       {space}{2,} */
return L("{space}{2,}"),25;case 41:
/*! Conditions:: AFTER_TAG_NAME AFTER_KEYWORD AFTER_TEXT_TAG_NAME */ /*! Rule::       {space}{space} */
return this.pushState("TEXT"),L("space space"),this.unput(" "),25;case 42:
/*! Conditions:: AFTER_TAG_NAME AFTER_KEYWORD AFTER_TEXT_TAG_NAME */ /*! Rule::       {space}{classname} */
return this.pushState("ATTRS_END"),s.yytext=s.yytext.substring(1),3;case 43:if(
/*! Conditions:: AFTER_TAG_NAME AFTER_KEYWORD AFTER_TEXT_TAG_NAME */ /*! Rule::       {space}{classname_relaxed} */L("<AFTER_TAG_NAME,AFTER_KEYWORD,AFTER_TEXT_TAG_NAME>{space}{classname_relaxed} this.parser.options=",this.parser.options),this.yy.parser.options.allowDigitToStartClassName)return this.pushState("ATTRS_END"),s.yytext=s.yytext.substring(1),3;throw new Error("Classnames starting with a digit is not allowed. Set allowDigitToStartClassName to true to allow.");case 44:
/*! Conditions:: AFTER_TAG_NAME AFTER_KEYWORD AFTER_TEXT_TAG_NAME */ /*! Rule::       {space} */
return this.pushState("ATTRS_END"),L("<AFTER_TAG_NAME,AFTER_KEYWORD,AFTER_TEXT_TAG_NAME>{space}"),25;case 45:
/*! Conditions:: ATTRS_END MIXIN_PARAMS_END */ /*! Rule::       {space} */
return this.pushState("TEXT"),L("<ATTRS_END>{space}"),25;case 47:
/*! Conditions:: AFTER_TAG_NAME AFTER_KEYWORD AFTER_TEXT_TAG_NAME NO_MORE_SPACE */ /*! Rule::       .+ */
return L("70 yy_.yytext=",s.yytext),3;case 49:
/*! Conditions:: INITIAL ATTRS_END */ /*! Rule::       \.\s*$ */
return this.popState(),24;case 50:
/*! Conditions:: ASSIGNMENT_VALUE */ /*! Rule::       .+ */
return this.popState(),33;case 51:
/*! Conditions:: ATTRS_END */ /*! Rule::       .+ */
return L("6 yy_.yytext=",s.yytext),3;case 52:
/*! Conditions:: UNBUF_CODE_START */ /*! Rule::       {space} */
return L("<UNBUF_CODE_START>{space}"),25;case 54:return this.popState(),this.pushState("MIXIN_PARAMS_STARTED"),11;case 55:
/*! Conditions:: MIXIN_CALL_START */ /*! Rule::       {space}$ */this.popState();break;case 56:
/*! Conditions:: TEXT */ /*! Rule::       .+ */
return L("80 yy_.yytext=",s.yytext),3;case 57:
/*! Conditions:: MULTI_LINE_ATTRS */ /*! Rule::       ,?(.*)\) */
return L("110 this.matches=",this.matches),this.popState(),s.yytext=this.matches[1],6;case 59:
/*! Conditions:: MIXIN_PARAMS_STARTED */ /*! Rule::       \) */
return this.popState(),this.pushState("MIXIN_PARAMS_END"),s.yytext="",["RPAREN","MIXIN_PARAMS"];case 60:
/*! Conditions:: MIXIN_PARAMS_STARTED */ /*! Rule::       (.+)(\)) */this.popState(),this.pushState("MIXIN_PARAMS_END"),L("120 this.matches=",this.matches),L("120 this.matches.length=",this.matches.length),L("120 yy_.yytext=",s.yytext);try{this.unput(")"),this.matches.length>1&&(s.yytext=this.matches[1])}catch(t){console.error(t)}return!1,L("120 yy_.yytext=",s.yytext),13;case 61:
/*! Conditions:: INITIAL */ /*! Rule::       <!--.+--> */
return s.yytext=s.yytext.slice(4,-3),9;case 62:
/*! Conditions:: UNBUF_CODE */ /*! Rule::       . */this.popState(),this.unput(s.yytext);break;default:return this.simpleCaseActionClusters[e]}},simpleCaseActionClusters:{
/*! Conditions:: INITIAL */ /*! Rule::       -{space}*$ */10:10,
/*! Conditions:: ATTRS_END */ /*! Rule::       \) */28:14,
/*! Conditions:: AFTER_TAG_NAME AFTER_TEXT_TAG_NAME ATTRS_END */ /*! Rule::       \.\s*$ */46:24,
/*! Conditions:: UNBUF_CODE_START */ /*! Rule::       .+ */53:4,
/*! Conditions:: MULTI_LINE_ATTRS */ /*! Rule::       .+ */58:7,
/*! Conditions:: UNBUF_CODE_BLOCK */ /*! Rule::       .+ */63:19},rules:[/^(?:#\[((a|abbr|acronym|address|applet|area|article|aside|audio|b|base|basefont|bdi|bdo|bgsound|big|blink|blockquote|body|br|button|canvas|caption|center|cite|code|col|colgroup|content|data|datalist|dd|del|details|dfn|dialog|dir|div|dl|dt|em|embed|fb|fieldset|figcaption|figure|font|foo|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hgroup|hr|html|i|iframe|image|img|input|ins|kbd|keygen|label|legend|li|link|main|map|mark|marquee|math|menu|menuitem|meta|meter|nav|nobr|noembed|noframes|noscript|object|ol|optgroup|option|output|p|param|picture|plaintext|portal|pre|progress|q|rb|rp|rt|rtc|ruby|s|samp|section|select|shadow|slot|small|source|spacer|span|strike|strong|sub|summary|sup|svg|table|tbody|td|template|textarea|tfoot|th|thead|time|title|tr|track|tt|u|ul|var|video|wbr|xmp)\b))/i,/^(?:((append|block|case|default|doctype|each|else|extends|for|if|include|mixin|prepend|unless|when|while)\b))/i,/^(?:((a|abbr|acronym|address|applet|area|article|aside|audio|b|base|basefont|bdi|bdo|bgsound|big|blink|blockquote|body|br|button|canvas|caption|center|cite|code|col|colgroup|content|data|datalist|dd|del|details|dfn|dialog|dir|div|dl|dt|em|embed|fb|fieldset|figcaption|figure|font|foo|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hgroup|hr|html|i|iframe|image|img|input|ins|kbd|keygen|label|legend|li|link|main|map|mark|marquee|math|menu|menuitem|meta|meter|nav|nobr|noembed|noframes|noscript|object|ol|optgroup|option|output|p|param|picture|plaintext|portal|pre|progress|q|rb|rp|rt|rtc|ruby|s|samp|section|select|shadow|slot|small|source|spacer|span|strike|strong|sub|summary|sup|svg|table|tbody|td|template|textarea|tfoot|th|thead|time|title|tr|track|tt|u|ul|var|video|wbr|xmp)\b))/i,/^(?:(script|style))/i,/^(?:(#[\d\-a-z]+))/i,/^(?:(\+\s*[a-z]+\b))/i,/^(?:\})/i,/^(?:{conditional})/i,/^(?:\()/i,/^(?:.+\))/i,/^(?:-([   -​\u2028\u2029　])*$)/i,/^(?:-)/i,/^(?:(\.-?[^\W\d]+[\w\-]*))/i,/^(?:(\.-?\w+[\w\-]*))/i,/^(?:\/\/)/i,/^(?:<[A-Z_]+>)/i,/^(?:\| )/i,/^(?:\|\.)/i,/^(?:\|$)/i,/^(?:&attributes\([^)]+\))/i,/^(?:(#\{.+\}))/i,/^(?:.+)/i,/^(?:(#\{))/i,/^(?:<\/.+)/i,/^(?:= )/i,/^(?:: )/i,/^(?:(:[\d\-a-z]+\b))/i,/^(?:\()/i,/^(?:\))/i,/^(?:\))/i,/^(?:(\.-?[^\W\d]+[\w\-]*))/i,/^(?:(\.-?\w+[\w\-]*))/i,/^(?:(\(.+|.+\().+)/i,/^(?:([^)]+)(\))(?!\s*\..+\)))/i,/^(?:(.+)\)\s*$)/i,/^(?:(.+)\)\.?\s*(.+)$)/i,/^(?:(.+)\.?\s*$)/i,/^(?:(#[\d\-a-z]+))/i,/^(?:(\.-?[^\W\d]+[\w\-]*))/i,/^(?:(\.-?\w+[\w\-]*))/i,/^(?:([   -​\u2028\u2029　]){2,})/i,/^(?:([   -​\u2028\u2029　])([   -​\u2028\u2029　]))/i,/^(?:([   -​\u2028\u2029　])(\.-?[^\W\d]+[\w\-]*))/i,/^(?:([   -​\u2028\u2029　])(\.-?\w+[\w\-]*))/i,/^(?:([   -​\u2028\u2029　]))/i,/^(?:([   -​\u2028\u2029　]))/i,/^(?:\.\s*$)/i,/^(?:.+)/i,/^(?:=([   -​\u2028\u2029　]))/i,/^(?:\.\s*$)/i,/^(?:.+)/i,/^(?:.+)/i,/^(?:([   -​\u2028\u2029　]))/i,/^(?:.+)/i,/^(?:\()/i,/^(?:([   -​\u2028\u2029　])$)/i,/^(?:.+)/i,/^(?:,?(.*)\))/i,/^(?:.+)/i,/^(?:\))/i,/^(?:(.+)(\)))/i,/^(?:<!--.+-->)/i,/^(?:.)/i,/^(?:.+)/i],conditions:{TEXT:{rules:[16,56],inclusive:!1},TEXT_START:{rules:[],inclusive:!1},AFTER_TAG_NAME:{rules:[19,24,25,27,37,38,39,41,42,43,44,46,47],inclusive:!1},ATTRS_STARTED:{rules:[32,33,34,35,36],inclusive:!1},ATTR_TEXT:{rules:[],inclusive:!1},MIXIN_CALL_START:{rules:[54,55],inclusive:!1},ATTRS_END:{rules:[19,28,30,31,45,46,48,49,51],inclusive:!0},CODE_START:{rules:[],inclusive:!1},UNBUF_CODE:{rules:[11,62],inclusive:!1},MULTI_LINE_ATTRS:{rules:[57,58],inclusive:!1},COMMENT:{rules:[],inclusive:!1},AFTER_ATTRS:{rules:[25],inclusive:!1},AFTER_TEXT_TAG_NAME:{rules:[27,41,42,43,44,46,47],inclusive:!1},AFTER_KEYWORD:{rules:[26,41,42,43,44,47],inclusive:!1},NO_MORE_SPACE:{rules:[47],inclusive:!1},ASSIGNMENT_VALUE:{rules:[50],inclusive:!1},COND_START:{rules:[8,9],inclusive:!1},INTERPOLATION_START:{rules:[],inclusive:!1},MIXIN_PARAMS_STARTED:{rules:[59,60],inclusive:!1},HTML_COMMENT_STARTED:{rules:[],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,7,10,11,12,13,14,15,16,17,18,19,20,22,23,30,31,40,49,61],inclusive:!0},INTERPOLATION:{rules:[21],inclusive:!1},MIXIN_PARAMS_END:{rules:[29,45],inclusive:!1},UNBUF_CODE_START:{rules:[52,53],inclusive:!1},UNBUF_CODE_BLOCK:{rules:[63],inclusive:!1}}};return e}();O.lexer=w;const I=!0,L=s("pug-line-lexer");const $=new i;function D(t){return'"'+t+'"'}function j(t,e){if(null==t||r.isEmpty(t))return L("empty/undefined obj, returning src"),e;if(null==e||r.isEmpty(e))return L("empty/undefined src, returning obj"),t;if(Array.isArray(e)&&e.length>0&&(e=e.reduce(j),L("src reduced to=",e)),L("merging",t,e),"text"!=t.type&&1==Object.keys(e).length&&"children"==Object.keys(e)[0]&&1==e.children.length&&e.children[0].hasOwnProperty("type")&&"text"==e.children[0].type)return Object.assign(t,{val:e.children[0].val});let s=r.mergeWith(t,e,(function(t,e,r,s,i,n){return L("merging","inside _mergeWith",r,t,e),null==t&&null==e?{}:null==t?e:null==e?t:(a=t,"text"===(o=e)||a===o?a:a.concat(o));var a,o}));return L("merging"," returning",s),s}function M(t,r){const i=s("pug-line-lexer:createElems"),n=t.matchAll(/#[\[\{].*?[\]\}]/g);let a=0,o=[];for(const e of n){if(i("match=",e),a!=e.index){const r=t.substring(a,e.index);i("pushing text onto element array:",r),o.push({type:"text",val:r}),a=e.index}if("["==e[0][1]){i("found left bracked");const t=e[0].slice(2,-1);i("sending to parser:",t);const s=r.parse(t);i("received from parser:",s),o.push(s)}else i("pushing interpolation value to arr:",e[0].slice(2,-1)),o.push({type:"interpolation",val:e[0].slice(2,-1)});a+=e[0].length}return a!=t.length&&o.push({type:"text",val:t.substring(a,t.index)}),i("returning=",e.inspect(o,!1,5)),o}function C(){this.yy={}}C.prototype=O,O.Parser=C;var F={parser:O,Parser:C,parse:function(){return O.parse.apply(O,arguments)}};export{F as Parser,f as InlineParser,S as AttrsParser};
//# sourceMappingURL=module.js.map
